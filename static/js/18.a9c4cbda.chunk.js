(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[18],{1159:function(e,t,n){"use strict";n.r(t);var a=n(3),o=n(1),i=n(6),u=n(0),c=n.n(u),l=n(16),r=n.n(l),s=n(28),m=n(42),d=n(30),h=n(1051),g=n(679),b=n(22),v=n(37),f=n(36),C=n(35),N=n(92),T=n(23),O=n(7),j=n(17),y=n(301),p=n(292),x={name:{id:"name",name:"T\xean NL",width:110,className:"text-small font-weight-bold",isSearch:!0,fixed:!0,sorter:Object(T.r)("searchName")},nhomNguyenLieuName:{id:"nhomNguyenLieuName",name:"Nh\xf3m NL",width:100,align:"center",className:"text-small",sorter:Object(T.r)("nhomNguyenLieu")},quantitative:{id:"quantitative",className:"text-small",name:"T\xean \u0110L",width:50,align:"center"},nhaCungCapId:{id:"nhaCungCapId",name:"NCC",width:100,align:"center",className:"superSmallTextExtra font-weight-bold",sorter:Object(T.r)("nhaCungCapId")},tonDau:{id:"tonDau",name:"T\u1ed3n \u0111\u1ea7u",width:100,className:"text-small font-weight-bold",align:"right",render:function(e){return e?Object(O.f)(e):""}},soLuongThuc:{id:"soLuongThuc",name:"Nh\u1eadp",width:100,align:"right",className:"text-small font-weight-bold",render:function(e){return e?Object(O.f)(e):""}},soLuong:{id:"soLuong",name:"S\u1ed1 l\u01b0\u1ee3ng",width:100,className:"text-small text-info font-weight-bold",align:"right",render:function(e){return e?Object(O.f)(e):""}},tongSoLuong:{id:"tongSoLuong",name:"T\u1ed5ng SL",width:100,className:"text-small text-info font-weight-bold",align:"right",render:function(e){return e?Object(O.f)(e):""}},tonCuoi:{id:"tonCuoi",name:"T\u1ed3n cu\u1ed1i",width:100,className:"text-small text-danger font-weight-bold hoverClass",align:"right",render:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=a.addTonCuoiModalHande,i=a.actions;return c.a.createElement("div",{onClick:function(){o.open()({}),i.setState({selectedKiemTonData:t})}},e?Object(O.f)(e):"--")},renderInput:function(){return c.a.createElement(y.a,{autoFocus:!0,style:{width:"100%"}})}},xuatKhac:{id:"xuatKhac",name:"Xu\u1ea5t kh\xe1c",width:85,className:"text-small text-success font-weight-bold",align:"right"},xuat:{id:"xuat",name:"Xu\u1ea5t",width:100,className:"text-small font-weight-bold",align:"right",render:function(e){var t=e&&e<0?"text-danger":"";return c.a.createElement("div",{className:t},e?Object(T.o)(e):"")}},duTru:{id:"duTru",name:"D\u1ef1 tr\xf9",width:90,className:"text-small font-weight-bold",align:"right",render:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,n=t.xuat,a=void 0===n?0:n,o=a-e,i=o>0?"text-danger":"";return c.a.createElement("div",{className:i},e?Object(T.o)(e):"")}},price:{id:"price",name:"Gi\xe1",className:"text-small",width:80,align:"right",render:function(e){return e?Object(O.f)(e):""}},thanhTien:{id:"thanhTien",name:"Th\xe0nh ti\u1ec1n",className:"right",width:110,align:"right"},chiPhi:{id:"chiPhi",name:"Chi ph\xed",width:110,className:"text-small font-weight-bold",align:"right",render:function(e){var t=e&&e<0?"text-danger":"";return c.a.createElement("div",{className:t},e?Object(O.f)(e):"")}},getTableDienColumns:function(){return[j.c.stt,this.name,this.nhaCungCapId,this.quantitative,Object(o.a)(Object(o.a)({},this.tonDau),{},{name:"CS \u0111\u1ea7u"}),Object(o.a)(Object(o.a)({},this.tonCuoi),{},{name:"CS cu\u1ed1i"}),Object(o.a)(Object(o.a)({},this.xuat),{},{name:"SL s\u1eed d\u1ee5ng"}),this.price,this.chiPhi]},getTableXuatKhacColumns:function(){return[j.c.stt,p.a.tenNguyenLieu,p.a.tenNhaCungCap,p.a.tenNhomNguyenLieu,p.a.tenDonViTinh,this.soLuong,p.a.giaNguyenLieu,this.chiPhi]},getTableColumns:function(){return[j.c.stt,p.a.tenNguyenLieu,p.a.tenNhaCungCap,p.a.giaNguyenLieu,p.a.tenDonViTinh,this.tonDau,this.soLuongThuc,this.tongSoLuong,this.tonCuoi,this.xuatKhac,this.xuat,this.duTru,this.chiPhi]},getInputFields:function(){return[this.tonCuoi]},getExcelFields:function(){return[]}},E=function(e){Object(f.a)(n,e);var t=Object(C.a)(n);function n(e){var a;return Object(b.a)(this,n),(a=t.call(this,e)).tableColumns=x.getTableColumns(),a.tableDienColumns=x.getTableDienColumns(),a.tableXuatKhacColumns=x.getTableXuatKhacColumns(),a.inputFields=x.getInputFields(),a}return Object(v.a)(n,[{key:"getTableDienColumns",value:function(e){var t=this;return this.tableDienColumns.map((function(n){return t.getGeneralFields(n,e)}))}},{key:"getTableXuatKhacColumns",value:function(e){var t=this;return this.tableXuatKhacColumns.map((function(n){return t.getGeneralFields(n,e)}))}}]),n}(N.a),w=n(9),D=n(8),L=n.n(D),P=n(11),S=n(69),M=Object(u.memo)((function(e){var t=e.pageData,n=e.tongColSpan,a=c.a.useMemo((function(){return[{id:"tong",colSpan:n||5,cellClassName:"font-weight-bold text-danger text-small text-center"},{id:"tonDau",cellClassName:"font-weight-bold text-danger text-small text-right"},{id:"soLuongThuc",cellClassName:"font-weight-bold text-danger text-small text-right"},{id:"tongSoLuong",cellClassName:"font-weight-bold text-danger text-small text-right"},{id:"tonCuoi",cellClassName:"font-weight-bold text-danger text-small text-right"},{id:"empty1",cellClassName:"font-weight-bold text-danger text-small text-right"},{id:"xuat",cellClassName:"font-weight-bold text-danger text-small text-right"},{id:"empty2",cellClassName:"font-weight-bold text-danger text-small text-right"},{id:"chiPhi",cellClassName:"font-weight-bold text-danger text-small text-right"}]}),[]),i=c.a.useMemo((function(){var e=["tonDau","soLuongThuc","tongSoLuong","tonCuoi","xuat"];return t.reduce((function(t,n){var a=n.price,i=void 0===a?0:a;return e.reduce((function(e,t){var a=(null===e||void 0===e?void 0:e[t])||0,u=((null===n||void 0===n?void 0:n[t])||0)*i;return Object(o.a)(Object(o.a)({},e),{},Object(w.a)({},t,a+u))}),t)}),{})}),[t]),u=c.a.useMemo((function(){return t.reduce((function(e,t){var n=t.price,a=void 0===n?0:n;return e+(null===t||void 0===t?void 0:t.xuat)*a}),0)}),[t]),l=c.a.useMemo((function(){return[{tong:"T\u1ed5ng"},{tonDau:Object(O.f)(null===i||void 0===i?void 0:i.tonDau)},{soLuongThuc:Object(O.f)(null===i||void 0===i?void 0:i.soLuongThuc)},{tongSoLuong:Object(O.f)(null===i||void 0===i?void 0:i.tongSoLuong)},{tonCuoi:Object(O.f)(null===i||void 0===i?void 0:i.tonCuoi)},{empty1:""},{xuat:Object(O.f)(null===i||void 0===i?void 0:i.xuat)},{empty2:""},{chiPhi:Object(O.f)(u)}]}),[i,u]);return c.a.createElement(S.b,{columns:a,dataSource:l})})),k=n(127),K=Object(u.memo)((function(e){var t=e.columns,n=e.state,a=e.actions,u=e.nhomNguyenLieuData,l=e.baoCaoComState,r=e.baoCaoComActions,m=e.loading,d=n.tongDoanhThuCom,h=n.tongDoanhThuCombo,g=n.vendors,b=n.xuatKhacs,v=n.nguyenLieuDatasBaoCao,f=u.id,C=u.showAllNguyenLieu,N=u.isKhongThuGon,j=Object(k.a)()[0].groupedNguyenLieu,y=null===l||void 0===l?void 0:l["show".concat(u.id)],p=(null===n||void 0===n?void 0:n["tongTien".concat(u.id)])||0,x=c.a.useState(!N),E=Object(i.a)(x,2),D=E[0],S=E[1],K=c.a.useState(!1),B=Object(i.a)(K,2),A=B[0],I=B[1],Q=n.chiTietNguyenLieuDatas,X=n.tonDauComs,R=n.tonCuoiComs,F=c.a.useMemo((function(){if(!Q)return[];var e=((null===j||void 0===j?void 0:j[f])||[]).reduce((function(e,t){var n,a,i,u=t.id,c=t.name,l=t.price,r=void 0===l?0:l,s=t.nhaCungCapId,m=null===Q||void 0===Q?void 0:Q[u];if(!(null===t||void 0===t?void 0:t.active))return e;var d=(null===b||void 0===b||null===(n=b[u])||void 0===n?void 0:n.soLuong)||0,h=(null===v||void 0===v||null===(a=v[u])||void 0===a?void 0:a.tongDinhLuong)||0,f=Number((null===X||void 0===X?void 0:X[u])||0),N=Number((null===R||void 0===R?void 0:R[u])||0),j=(null===t||void 0===t?void 0:t.searchName)?t.searchName:Object(O.y)(c),y=(null===g||void 0===g||null===(i=g[s])||void 0===i?void 0:i.name)||s;if(m||C){var p=m||{},x=p.soLuongThuc,E=void 0===x?0:x,w=p.price;w=w||r;var D=Number(E)+f,L=D-N-d,P=C?t:{},S=Object(o.a)(Object(o.a)(Object(o.a)({},P),m),{},{searchName:j,chiPhi:Object(T.o)(L*w),tonDau:f,tongSoLuong:D,tonCuoi:N,xuat:L,xuatKhac:d,nhaCungCapId:y,duTru:h});e.push(S)}else{if((null===X||void 0===X?void 0:X[u])||(null===R||void 0===R?void 0:R[u])){var M=f,k=M-N-d,K=(null===t||void 0===t?void 0:t.price)||0,B=Object(o.a)(Object(o.a)({},t),{},{nhaCungCapId:y,searchName:j,chiPhi:Object(T.o)(k*K),tonDau:f,tongSoLuong:M,tonCuoi:N,xuat:k,xuatKhac:d,duTru:h});e.push(B)}}return e}),[]);return D&&A?e=e.filter((function(e){return(null===e||void 0===e?void 0:e.xuat)&&(null===e||void 0===e?void 0:e.tongSoLuong)})).map((function(e,t){return Object(o.a)(Object(o.a)({},e),{},{nextIndex:t+1})})):D?e=e.filter((function(e){return null===e||void 0===e?void 0:e.xuat})).map((function(e,t){return Object(o.a)(Object(o.a)({},e),{},{nextIndex:t+1})})):A&&(e=e.filter((function(e){return null===e||void 0===e?void 0:e.tongSoLuong})).map((function(e,t){return Object(o.a)(Object(o.a)({},e),{},{nextIndex:t+1})}))),e=(e=Object(P.orderBy)(e,"searchName")).map((function(e,t){return Object(o.a)(Object(o.a)({},e),{},{nextIndex:t+1})}))}),[j,Q,D,A,X,R,g,b,v]);c.a.useEffect((function(){return a.setTongTienNhomNguyenLieu(F,u)}),[F]);var H=c.a.useMemo((function(){return!(!F||!y)&&F.length>0}),[F,y]),G=c.a.useMemo((function(){var e=Object(T.o)(p/d*100);return"comboChinh"===u.id&&(e=Object(T.o)(p/h*100)),e}),[d,h,p,u]);return c.a.createElement("div",{className:"mt-2 mb-3"},c.a.createElement("div",{className:"py-1 font-weight-bold text-warning hoverClassBG d-flex justify-content-between align-items-center",onClick:function(){r.setState(Object(w.a)({},"show".concat(u.id),!y))}},c.a.createElement("div",{className:"mr-1"},c.a.createElement("span",null,u.name,": ",Object(O.d)(p)),c.a.createElement("span",{className:"ml-1 text-danger text-small font-weight-bold"},"(",G,"%)")),c.a.createElement("div",null,c.a.createElement("button",{className:L()("btn btn-sm mr-1",{"btn-warning":A,"btn-outline-warning":!A}),onClick:function(e){e.stopPropagation(),I(!A)}},c.a.createElement("i",{className:"fa fa-minus"})," ",c.a.createElement(s.ResponsiveText,null,"T\u1ed5ng SL")),c.a.createElement("button",{className:L()("btn btn-sm",{"btn-warning":D,"btn-outline-warning":!D}),onClick:function(e){e.stopPropagation(),S(!D)}},c.a.createElement("i",{className:"fa fa-minus"})," ",c.a.createElement(s.ResponsiveText,null,"Xu\u1ea5t")))),!H&&c.a.createElement(s.AntTable,{loading:m,className:"baoCaoComTable",rowKey:"id",bordered:!0,size:"small",columns:t,dataSource:F,scroll:{x:600,y:300},summary:function(e){return c.a.createElement(M,{nhomNguyenLieuData:u,pageData:e})}}))})),B=n(335),A=Object(u.memo)((function(e){var t=e.addTonCuoiModalHande,n=e.state,a=e.actions,u=e.nhomNguyenLieuData,l=e.baoCaoComState,r=e.baoCaoComActions,m=e.loading,d=u.showAllNguyenLieu,h=u.isKhongThuGon,g=null===l||void 0===l?void 0:l["show".concat(u.id)],b=(null===n||void 0===n?void 0:n["tongTien".concat(u.id)])||0,v=c.a.useState(!h),f=Object(i.a)(v,2),C=f[0],N=f[1],j=n.groupedNguyenLieu,y=n.chiTietNguyenLieuDatas,p=n.tonDauComs,x=n.tonCuoiComs,D=n.tongDoanhThuCom,P=c.a.useMemo((function(){if(!y&&!m)return[];var e=((null===j||void 0===j?void 0:j.dien)||[]).reduce((function(e,t){var n=t.id,a=t.name,i=null===y||void 0===y?void 0:y[n];if(!(null===t||void 0===t?void 0:t.active))return e;var u=(null===t||void 0===t?void 0:t.price)||0,c=(null===p||void 0===p?void 0:p[n])||0,l=(null===x||void 0===x?void 0:x[n])||0,r=(null===t||void 0===t?void 0:t.searchName)?t.searchName:Object(O.y)(a);if(i||d){var s=l-c,m=d?t:{},h=Object(o.a)(Object(o.a)(Object(o.a)({},m),i),{},{searchName:r,chiPhi:Math.round(s*u),tonDau:c,tonCuoi:l,xuat:s});e.push(h)}else{if(null===p||void 0===p?void 0:p[n]){var g=l-c,b=(null===t||void 0===t?void 0:t.price)||0,v=Object(o.a)(Object(o.a)({},t),{},{searchName:r,chiPhi:Math.round(g*b),tonDau:c,tonCuoi:l,xuat:g});e.push(v)}}return e}),[]);return e=e.map((function(e,t){return Object(o.a)(Object(o.a)({},e),{},{nextIndex:t+1})}))}),[j,y,C,p,x,m]);c.a.useEffect((function(){return a.setTongTienNhomNguyenLieu(P,u)}),[P]);var S=c.a.useMemo((function(){return!(!P||!g)&&P.length>0}),[P,g]),M=Object(B.b)(),k=Object(i.a)(M,3),K=k[0],A=k[1],I=k[2],Q=c.a.useMemo((function(){return(new E).getTableDienColumns({searchText:K,setSearchText:A,searchInput:I,addTonCuoiModalHande:t,actions:a})}),[K,I]),X=c.a.useMemo((function(){return Object(T.o)(b/D*100)}),[D,b]);return c.a.createElement("div",{className:"mt-2 mb-3"},c.a.createElement("div",{className:"py-1 font-weight-bold text-warning hoverClassBG d-flex justify-content-between align-items-center",onClick:function(){r.setState(Object(w.a)({},"show".concat(u.id),!g))}},c.a.createElement("div",{className:"mr-1"},c.a.createElement("span",null,u.name,": ",Object(O.d)(b)),c.a.createElement("span",{className:"ml-1 text-danger text-small font-weight-bold"},"(",X,"%)")),c.a.createElement("div",null,c.a.createElement("button",{className:L()("btn btn-sm",{"btn-warning":C,"btn-outline-warning":!C}),onClick:function(e){e.stopPropagation(),N(!C)}},c.a.createElement("i",{className:"fa fa-minus"})," ",c.a.createElement(s.ResponsiveText,null,"Thu g\u1ecdn")))),!S&&c.a.createElement(s.AntTable,{loading:m,className:"baoCaoComTable",rowKey:"id",bordered:!0,size:"small",columns:Q,dataSource:P,scroll:{x:600,y:300}}))})),I=n(618),Q=Object(u.memo)((function(e){var t=e.pageData,n=e.tongColSpan,a=c.a.useMemo((function(){return[{id:"tong",colSpan:n||7,cellClassName:"font-weight-bold text-danger text-small text-center"},{id:"chiPhi",cellClassName:"font-weight-bold text-danger text-small text-right"}]}),[]),o=c.a.useMemo((function(){return t.reduce((function(e,t){var n=t.price,a=void 0===n?0:n,o=t.soLuong;return e+(void 0===o?0:o)*a}),0)}),[t]),i=c.a.useMemo((function(){return[{tong:"T\u1ed5ng"},{chiPhi:Object(O.e)(o)}]}),[o]);return c.a.createElement(S.b,{columns:a,dataSource:i})})),X=Object(u.memo)((function(e){var t=e.state,n=e.actions,a=e.nhomNguyenLieuData,u=e.baoCaoComState,l=e.baoCaoComActions,r=e.dayTimePicker,m=e.selectedTime,d=(a.id,null===u||void 0===u?void 0:u["show".concat(a.id)]),h=t.xuatKhacsArray,g=t.nhomNguyenLieus,b=c.a.useMemo((function(){return h?h=h.map((function(e){var t,n=e.soLuong,a=void 0===n?0:n,i=e.price,u=void 0===i?0:i,c=e.nhomNguyenLieu,l=a*u,r=(null===g||void 0===g||null===(t=g[c])||void 0===t?void 0:t.name)||c;return Object(o.a)(Object(o.a)({},e),{},{nhomNguyenLieuName:r,chiPhi:l})})):[]}),[h]);c.a.useEffect((function(){return n.getXuatKhacs(r),function(){return n.stopListenXuatKhac()}}),[m]);var v=Object(I.b)({onUpdate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=e.selectNguyenLieu,o=e.soLuong;n.setXuatKhac({selectNguyenLieu:a,soLuong:o},r,t)},state:t,actions:n}),f=Object(i.a)(v,2),C=f[0],N=f[1],T=c.a.useMemo((function(){return(new E).getTableXuatKhacColumns({state:t})}),[]);return c.a.createElement("div",{className:"mt-2 mb-3"},c.a.createElement("div",{className:"py-1 font-weight-bold text-warning hoverClassBG d-flex justify-content-between align-items-center",onClick:function(){l.setState(Object(w.a)({},"show".concat(a.id),!d))}},c.a.createElement("div",{className:"mr-1"},c.a.createElement("span",null,a.name)),c.a.createElement("div",null,c.a.createElement("button",{className:L()("btn btn-sm btn-success"),onClick:function(e){e.stopPropagation(),C.open()({})}},c.a.createElement("i",{className:"fa fa-plus"})," ",c.a.createElement(s.ResponsiveText,null,"Th\xeam s\u1ea3n ph\u1ea9m")))),c.a.createElement(s.AntTable,{className:"baoCaoComTable",rowKey:"id",bordered:!0,size:"small",columns:T,dataSource:b,scroll:{x:600,y:300},onRow:function(e){return{onClick:function(){C.open()(e)}}},summary:function(e){return c.a.createElement(Q,{pageData:e})}}),C.getRender(N))})),R=n(448),F=function(e){Object(f.a)(n,e);var t=Object(C.a)(n);function n(e){var a;return Object(b.a)(this,n),(a=t.call(this,e)).tableColumns=R.a.getTableColumns(),a}return n}(N.a),H=Object(u.memo)((function(e){var t=e.state,n=e.baoCaoComState,a=e.baoCaoComActions,o=e.loading,i=e.chiPhiMuaQuayNuocTrongNgay,u=t.tongDoanhThuNgay,l=t.tongDoanhThuCom,r=t.tongDoanhThuCombo,m=t.nhomNguyenLieuComsArray,d=t.nhomThucPhamBaoCaosArray,h=t.nhomNgoaiThucPhamBaoCaosArray,g=t.nhomChiPhiComboArray,b=t.nhomChiPhiKhacBaoCaosArray,v=t.doanhThuNgay,f=t.doanhThuDem,C=t.tienCongs,N=n.chiPhiChuaNhanSu,O=n.chiPhiCombo,j=n.thucPham,y=c.a.useMemo((function(){var e=(C||{}).tongTienNhanSu;return(void 0===e?0:e)+N||0}),[C,N]),p=c.a.useMemo((function(){return(y||0)+(O||0)}),[O,y]),x=c.a.useMemo((function(){return(new F).getTableColumns({})}),[]);c.a.useEffect((function(){if(m){var e=m.reduce((function(e,n){var a=n.id;return e+((null===t||void 0===t?void 0:t["tongTien".concat(a)])||0)}),7e4),n=d.reduce((function(e,n){var a=n.id;return e+((null===t||void 0===t?void 0:t["tongTien".concat(a)])||0)}),0),o=h.reduce((function(e,n){var a=n.id;return e+((null===t||void 0===t?void 0:t["tongTien".concat(a)])||0)}),0),u=b.reduce((function(e,n){var a=n.id;return e+((null===t||void 0===t?void 0:t["tongTien".concat(a)])||0)}),0),c=g.reduce((function(e,n){var a=n.id;return e+((null===t||void 0===t?void 0:t["tongTien".concat(a)])||0)}),0);a.setState({chiPhiChuaNhanSu:e+(i||0),thucPham:n+(i||0),ngoaiThucPham:o,chiPhiKhac:u,chiPhiCombo:c})}else a.setState({chiPhiChuaNhanSu:0,thucPham:0,ngoaiThucPham:0,chiPhiKhac:0})}),[m,t,i]);var E=c.a.useMemo((function(){var e=C||{},t=e.tongTienNhanSu,n=e.tienNhanSuNgay,a=e.tienNhanSuDem,o=(p||0)-(t||0);return[{id:"tongDoanhThuNgay",name:"T\u1ed5ng doanh thu",tien:u},{id:"tongDoanhThuCom",name:"Doanh thu c\u01a1m",tien:l,ngay:v,dem:f,cost:Object(T.h)(l,u),costNgay:Object(T.h)(v,l),costDem:Object(T.h)(f,l)},{id:"tongDoanhThuCombo",name:"Doanh thu combo",tien:r,cost:Object(T.h)(r,u)},{id:"chiPhiChuaNhanSu",name:"CP c\u01a1m ch\u01b0a NS",tien:N,cost:Object(T.h)(N,l)},{id:"tongChiPhi",name:"Chi ph\xed c\u01a1m",tien:y,cost:Object(T.h)(y,l)},{id:"chiPhiCombo",name:"Chi ph\xed combo",tien:O,cost:Object(T.h)(O,r)},{id:"thucPham",name:"Th\u1ef1c ph\u1ea9m",tien:j,cost:Object(T.h)(j,l)},{id:"chiPhiNhanSu",name:"CP nh\xe2n s\u1ef1",cost:Object(T.h)(t,l),tien:t,ngay:n,costNgay:Object(T.h)(n,v),dem:a,costDem:Object(T.h)(a,f)},{id:"tongTongChiPhiChuaNhanSu",name:"T\u1ed5ng CP CNS",tien:o,cost:Object(T.h)(o,u)},{id:"tongTongChiPhi",name:"T\u1ed5ng chi ph\xed",tien:p,cost:Object(T.h)(p,u)}]}),[l,i,y,C,N,p]);return c.a.createElement("div",null,c.a.createElement(s.AntTable,{loading:o,className:"baoCaoComTable",rowKey:"id",bordered:!0,size:"small",dataSource:E,columns:x,scroll:{x:500}}))})),G=Object(u.memo)((function(e){var t=e.onOk,n=e.doanhThuKhacTrongNgay,a=c.a.useState(0),o=Object(i.a)(a,2),u=o[0],l=o[1];return c.a.useEffect((function(){l(n||0)}),[n]),c.a.createElement("div",null,c.a.createElement(s.InputNumber,{value:u,style:{width:"100%"},onBlur:function(e,t){return l(t)},autoFocus:!0}),c.a.createElement("div",{className:"align-right mt-3"},c.a.createElement("button",{onClick:function(){return t(u)},className:"btn btn-md btn-success"},"Ok")))})),Y=function(e){Object(f.a)(n,e);var t=Object(C.a)(n);function n(e){var a;return Object(b.a)(this,n),(a=t.call(this,e)).tableColumns=R.a.getTableChiTietColumns(),a}return n}(N.a),z=Object(u.memo)((function(e){var t=e.state,n=e.loading,i=t.tongDoanhThuCom,u=t.nhomNguyenLieuBaoCaoChiTietArray,l=t.chiPhiMuaQuayNuocTrongNgay,r=c.a.useMemo((function(){return(new Y).getTableColumns({})}),[]),m=c.a.useMemo((function(){var e=u.map((function(e){var n=e.id,a=e.name,o=(null===t||void 0===t?void 0:t["tongTien".concat(n)])||0;return"nuoc"===n?o=7e4:"chiPhiMuaQuayNuoc"===n&&(o=l),{id:n,name:a,tien:o,cost:Object(T.o)(o/i*100)}})),n=e.reduce((function(e,t){return Object(o.a)(Object(o.a)({},e),{},{cost:((null===e||void 0===e?void 0:e.cost)||0)+((null===t||void 0===t?void 0:t.cost)||0),tien:((null===e||void 0===e?void 0:e.tien)||0)+((null===t||void 0===t?void 0:t.tien)||0)})}),{});return[{id:"tongCost",name:"T\u1ed5ng CP ch\u01b0a NS",tien:null===n||void 0===n?void 0:n.tien,cost:null===n||void 0===n?void 0:n.cost}].concat(Object(a.a)(e))}),[i,t,u,l]);return c.a.createElement("div",null,c.a.createElement(s.AntTable,{loading:n,className:"baoCaoComTable",rowKey:"id",bordered:!0,size:"small",dataSource:m,columns:r}))})),q=Object(u.memo)((function(e){var t=e.onOk,n=e.chiPhiMuaQuayNuocTrongNgay,a=c.a.useState(0),o=Object(i.a)(a,2),u=o[0],l=o[1];return c.a.useEffect((function(){l(n||0)}),[n]),c.a.createElement("div",null,c.a.createElement(s.InputNumber,{value:u,style:{width:"100%"},onBlur:function(e,t){return l(t)},autoFocus:!0}),c.a.createElement("div",{className:"align-right mt-3"},c.a.createElement("button",{onClick:function(){return t(u)},className:"btn btn-md btn-success"},"Ok")))})),U=(N.a,n(241)),V=Object(u.memo)((function(e){var t=e.selectedTime,n=e.dayTimePicker,a=e.options,o=e.state,u=e.actions,l=o.selectedKiemTonData,r=c.a.useState({}),s=Object(i.a)(r,2),m=s[0],d=s[1],h=c.a.useMemo((function(){return new E}),[]),g=Object(U.a)({initData:l,configs:h.inputFields,onSubmit:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!t)return null;var a=null===l||void 0===l?void 0:l.id,o=e.tonCuoi,i=void 0===o?"":o,c=Object(T.s)(i),r={id:a,tonCuoi:c,tonCuoiString:i};u.updateKiemTonCom(r,{dayTimePicker:n})},onBlur:function(e){var t=e.target,n=t.name,a=t.value;m[n]=a,d(m)},options:a}),b=Object(i.a)(g,1)[0];return c.a.useEffect((function(){var e=Object(P.cloneDeep)(l);d(e)}),[l]),c.a.createElement("div",null,b.getRender())})),_=n(109),J=Object(u.memo)((function(e){var t,n,u=e.state,l=e.baoCaoComState,b=e.actions,v=u.nhomNguyenLieusArray,f=u.nhomNguyenLieuBaoCaosArray,C=u.chiTietNguyenLieuDatas,N=u.selectedKiemTonData,j=u.tonDauComs,y=u.chiPhiMuaQuayNuocTrongNgay,p=u.loadingTonDau,x=u.loadingTonCuoi,w=u.donDaNhanLoading,D=u.loadingNguyenLieuDB,L=Object(k.a)()[0].groupedNguyenLieu,S=c.a.useMemo((function(){return!1})),M=Object(d.d)({defaultTime:S?r()("11-01-2022","DD-MM-YYYY"):r()().subtract(1,"day")}),B=Object(i.a)(M,2),I=B[0],Q=B[1],R=Object(d.q)(),F=Object(i.a)(R,1)[0];c.a.useEffect((function(){return b.getDonDaNhans(Q),b.getThucDonDuTruByDay_BaoCao({dayPickerHandle:Q}),b.getChiPhiQuayNuocBaoCaoNgay(Q),b.getTonCuoiComs(Q),function(){b.stopListenTonCuoiCom(),b.stopChiPhiQuayNuocBaoCaoNgay(),b.setState({loading:!0,donDaNhans:{},donDaNhansArray:[],chiTietNguyenLieuDatas:{}})}}),[I]);var Y=function(e){b.setChiPhiQuayNuocBaoCaoNgay(e,Q)},U=Object(s.useModal)(),J=c.a.useMemo((function(){return{title:"".concat(null===N||void 0===N?void 0:N.tenNguyenLieu).toUpperCase(),Body:function(e){return c.a.createElement(V,Object.assign({},e,{selectedTime:I,dayTimePicker:Q,state:u,actions:b}))},footer:!1,maskClosable:!0,width:800}}),[N]),W=Object(s.useModal)(),Z=c.a.useMemo((function(){return{title:"Th\xeam Doanh Thu Kh\xe1c",Body:function(e){return c.a.createElement(G,e)},footer:!1,maskClosable:!0,width:500,bodyProps:{onOk:Y,chiPhiMuaQuayNuocTrongNgay:y}}}),[y]),$=Object(s.useModal)(),ee=c.a.useMemo((function(){return{title:"Th\xeam Chi Ph\xed Mua Qu\u1ea7y N\u01b0\u1edbc",Body:function(e){return c.a.createElement(q,e)},footer:!1,maskClosable:!0,width:500,bodyProps:{onOk:Y,chiPhiMuaQuayNuocTrongNgay:y}}}),[y]),te=Object(d.o)(),ne=Object(i.a)(te,3),ae=ne[0],oe=ne[1],ie=ne[2],ue=c.a.useMemo((function(){return(new E).getTableColumns({searchText:ae,setSearchText:oe,searchInput:ie,addTonCuoiModalHande:U,actions:b})}),[ae,ie]),ce={breadcrumbs:Object(a.a)((null===e||void 0===e||null===(t=e.breadcrumb)||void 0===t?void 0:t.breadcrumbs)||[]),buttons:[].concat(Object(a.a)((null===e||void 0===e||null===(n=e.breadcrumb)||void 0===n?void 0:n.buttons)||[]),[{element:c.a.createElement("button",{key:"1",className:"btn btn-sm btn-success mr-1",onClick:function(){var e=v.filter((function(e){return null===e||void 0===e?void 0:e.isKiemTon})),t=e.reduce((function(e,t){var n=t.id,i=((null===L||void 0===L?void 0:L[n])||[]).reduce((function(e,t){var n=t.id,i=(null===C||void 0===C?void 0:C[n])||{},u=(null===j||void 0===j?void 0:j[n])||0,c=i.soLuongThuc,l=void 0===c?0:c,r=(null===j||void 0===j?void 0:j[n])||0,s=Object(o.a)(Object(o.a)(Object(o.a)({},t),i),{},{nhap:l,tonDau:u,tonCuoi:r,tongSoLuong:Number(l)+Number(u)});return l||u||r?[].concat(Object(a.a)(e),[s]):e}),[]);return[].concat(Object(a.a)(e),Object(a.a)(i))}),[]);t=Object(P.orderBy)(t,["nhomNguyenLieu","searchName"]);var n=Object(P.groupBy)(t,"nhomNguyenLieu"),i=["name","tenNhaCungCap","tongSoLuong"],u=e.reduce((function(e,t){var o=t.id,u=t.name,c=((null===n||void 0===n?void 0:n[o])||[]).map((function(e){return i.map((function(t){return(null===e||void 0===e?void 0:e[t])||""}))}));return[].concat(Object(a.a)(e),[[u]],Object(a.a)(c))}),[["T\xean NL","NCC","T\u1ed5ng SL","T\u1ed3n cu\u1ed1i"]]);Object(_.c)([["datas",u]],"kiem_ton_com")}},c.a.createElement("i",{className:"fa fa-print"})," ",c.a.createElement("span",null,"In KT"))},{element:c.a.createElement("button",{key:"2",className:"btn btn-sm btn-warning mr-1",onClick:function(){var e=u.firebase;if(!I)return[];var t=I.format("DD-MM-YY"),n=u.tongDoanhThuCom,a=void 0===n?0:n,i=u.tongDoanhThuCombo,c=void 0===i?0:i,r=u.tongTientrangMieng,s=void 0===r?0:r,m=u.tongTiengaoBunMi,d=void 0===m?0:m,h=u.tongTiengiaVi,g=void 0===h?0:h,b=u.tongTienchiPhiKhac,v=void 0===b?0:b,f=u.tongTiengas,C=void 0===f?0:f,N=u.tongTiendien,j=void 0===N?0:N,y=u.tienCongs.tongTienNhanSu,p=void 0===y?0:y,x=l.chiPhiChuaNhanSu,E=void 0===x?0:x,w=l.chiPhiCombo,D=void 0===w?0:w,L=l.thucPham,P=void 0===L?0:L,S=Object(o.a)(Object(o.a)({id:t,key:t},Object(T.m)()),{},{doanhThu:a+c,tongChiPhi:E+D+p,doanhThuCom:a,doanhThuCombo:c,chiPhiCom:E+p,chiPhiCombo:D,chiPhi:E,thucPham:P,trangMieng:s,gao:d,giaVi:g,khac:v,gas:C,dien:j,nuoc:7e4,nhanSu:p}),M=["reports","xuongDauGiay","baoCaoCom",I.format("MM-YY"),t];e.database().ref(M.join("/")).set(S).then((function(){Object(O.w)("Updated success!")}))}},c.a.createElement("i",{className:"fa fa-upload"})," ",c.a.createElement("span",null,"Upload"))}])},le=c.a.useMemo((function(){return x||p||w||D}),[x,p,w,D]);return le?c.a.createElement(m.g,null):c.a.createElement("div",null,c.a.createElement(s.Breadcrumb,{breadcrumb:ce}),c.a.createElement("div",null,Q.getRender()),c.a.createElement(h.a,{gutter:8},c.a.createElement(g.a,{xs:24,md:14,lg:16},c.a.createElement("div",{className:"font-weight-bold text-danger py-2"},c.a.createElement("span",null,"T\u1ed5ng h\u1ee3p chung"),c.a.createElement("button",{className:"btn btn-sm btn-success ml-1",onClick:function(){return W.open()({})}},c.a.createElement("i",{className:"fa fa-plus"})," Doanh thu th\xeam")),c.a.createElement(H,Object.assign({},e,{chiPhiMuaQuayNuocTrongNgay:y,loading:le}))),c.a.createElement(g.a,{xs:24,md:10,lg:8},c.a.createElement("div",{className:"font-weight-bold text-danger py-2"},c.a.createElement("span",null,"T\u1ed5ng h\u1ee3p chi ti\u1ebft"),c.a.createElement("button",{className:"btn btn-sm btn-success ml-1",onClick:function(){return W.open()({})}},c.a.createElement("i",{className:"fa fa-plus"})," CP t\u1eeb n\u01b0\u1edbc")),c.a.createElement(z,Object.assign({},e,{loading:le})))),c.a.createElement("div",{className:"mt-1"},f.map((function(t){var n=t.id;return"dien"===n?c.a.createElement("div",{key:n},c.a.createElement(A,Object.assign({},e,{loading:le,addTonCuoiModalHande:U,settingHandle:F,nhomNguyenLieuData:t,columns:ue}))):"xuatKhac"===n?c.a.createElement("div",{key:n},c.a.createElement(X,Object.assign({},e,{loading:le,dayTimePicker:Q,addTonCuoiModalHande:U,settingHandle:F,nhomNguyenLieuData:t,columns:ue,selectedTime:I}))):c.a.createElement("div",{key:n},c.a.createElement(K,Object.assign({},e,{loading:le,settingHandle:F,nhomNguyenLieuData:t,columns:ue})))}))),U.getRender(J),W.getRender(Z),$.getRender(ee))}));t.default=J}}]);