(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[10],{1065:function(e,n,t){"use strict";t.d(n,"a",(function(){return g})),t.d(n,"b",(function(){return p}));var a=t(0),i=t.n(a),o=t(7),l=t(34),c=t(143),d=t(299),r=t(1017),u=t(664),s=t(665),h=t(41),m=d.a.TextArea,v=new c.b,f=new h.a,g={name:{id:"name",name:"Lo\u1ea1i m\xf3n",width:130,fixed:!0,render:function(e,n,t){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=(null===o||void 0===o?void 0:o.recipeKinds)||{};return i.a.createElement("strong",{className:"ml-2",style:{color:"blue"}},(null===l||void 0===l||null===(a=l[e])||void 0===a?void 0:a.name)||e)}},loaiMon:{id:"name",name:"Lo\u1ea1i m\xf3n",className:"text-small",width:130,render:function(e){return i.a.createElement("strong",null,e)}},tenMon:{id:"tenMon",name:"T\xean m\xf3n",className:"text-small",width:190,render:function(e,n,t,a){var o=a.shiftId,c=a.coSoId,d=a.customerId,r=a.dayId,u=a.history,s=a.customerGroupId,h=a.isView,m=e,f=n.id;return m?i.a.createElement("div",{style:{color:"#1012ff"},className:"hoverClass font-weight-bold",onClick:function(){if(h)return null;var e=[[l.c.MODAL_ID,l.a.editRecipe.id],[l.c.COSO_ID,c],[l.c.CUSTOMER_ID,d],[l.c.CUSTOMER_GROUP_ID,s],[l.c.RECIPE_ID,m]];v.pushURL(u,e)}},m):i.a.createElement("div",{className:"hoverClass",onClick:function(){if(console.log(h,"isView"),h)return null;var e=[[l.c.MODAL_ID,l.a.selectRecipe.id],[l.c.SHIFT_ID,o],[l.c.KIND_ID,f],[l.c.DAY_ID,r],[l.c.RECIPE_ID,m]];v.pushURL(u,e)}},"--")}},giaMon:{id:"giaMon",name:"Gi\xe1 m\xf3n",className:"text-small",width:80,align:"center",render:function(e,n,t){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=a.giaPhanAn,c=i.a.createElement("strong",{className:"text-danger float-right"},i.a.createElement("sub",null,Object(o.j)(e,l),"%")),d=i.a.createElement(r.a,null,i.a.createElement(u.a,{sm:24}," ",c));return e?d:""}},soPhanThem:{id:"soPhanThem",name:"SP th\xeam",className:"text-small",align:"center",width:80,render:function(e,n,t,a){var o=a.isInput,l=a.setIsInput,c=a.shiftId,d=a.onUpdate,r=a.isView,u="soPhanThem",h=n.id;return o.shiftId!==c||o.type!==u||r?i.a.createElement("div",{className:"hoverClass font-weight-bold",onClick:function(){return l({shiftId:c,type:u,recipeKindId:h})}},e||"--"):i.a.createElement(s.a,{tabIndex:t+1,autoFocus:(null===o||void 0===o?void 0:o.recipeKindId)===h,size:"small",step:5,defaultValue:e||"",onBlur:function(e){var n=Number(e.target.value);d(n,{type:u,recipeKindId:h})}})}},soPhanAn:{id:"soPhanAn",name:"SP \u0103n",align:"center",className:"text-small",width:70,render:function(e,n,t){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=a.isInput,l=a.setIsInput,c=a.shiftId,d=a.onUpdate,r=a.isView,u="soPhanAn",h=n.id,m=n.loaiMonId;return f.checkNotAddSoPhanAn(m)?e||"":o.shiftId!==c||o.type!==u||r?i.a.createElement("div",{className:"hoverClass font-weight-bold",onClick:function(){l({shiftId:c,type:u,recipeKindId:h})}},e||"--"):i.a.createElement(s.a,{tabIndex:t+1,autoFocus:(null===o||void 0===o?void 0:o.recipeKindId)===h,size:"small",min:0,step:10,defaultValue:e||"",onBlur:function(e){var n=Number(e.target.value);d(n,{type:u,recipeKindId:h})}})}},thanhTien:{id:"thanhTien",name:"Th\xe0nh ti\u1ec1n",align:"right",className:"text-small",width:90,render:function(e){return e?Object(o.d)(e):""}},ghiChu:{id:"ghiChu",name:"Ghi ch\xfa",width:230,className:"text-small",render:function(e,n,t,a){var o=a.isInput,l=a.setIsInput,c=a.shiftId,d=a.onUpdate,r=a.isView,u=n.id;return o.shiftId!==c||"ghiChu"!==o.type||r?i.a.createElement("div",{className:"hoverClass",onClick:function(){return l({shiftId:c,recipeKindId:u,type:"ghiChu"})}},e||"--"):i.a.createElement(m,{rows:3,tabIndex:t+1,autoFocus:u===o.recipeKindId,size:"small",defaultValue:e||"",style:{width:"100%"},onBlur:function(e){var n=e.target.value;d(n,{type:"ghiChu",recipeKindId:u})}})}}},p={name:{id:"name",name:"Lo\u1ea1i m\xf3n",width:110,fixed:!0,render:function(e,n,t){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=(null===o||void 0===o?void 0:o.recipeKinds)||{};return i.a.createElement("strong",{className:"ml-2"},(null===l||void 0===l||null===(a=l[e])||void 0===a?void 0:a.name)||e)}},loaiMon:{id:"tenLoaiMon",name:"Lo\u1ea1i m\xf3n",className:"text-small",width:110,render:function(e){return i.a.createElement("strong",null,e)}},tenMon:{id:"tenMon",name:"T\xean m\xf3n",className:"text-small",width:150,render:function(e){return e&&i.a.createElement("div",{className:"font-weight-bold",style:{color:"blue"}},e)}},giaMon:{id:"giaMon",name:"Gi\xe1 m\xf3n",className:"text-small",width:90,align:"center",render:function(e,n,t){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=a.giaPhanAn,c=i.a.createElement("strong",{className:"text-danger float-right"},i.a.createElement("sub",null,Object(o.j)(e,l),"%")),d=i.a.createElement(r.a,null,i.a.createElement(u.a,{sm:24}," ",c));return e?d:""}},soPhanThem:{id:"soPhanThem",name:"SP th\xeam",className:"text-small",align:"right",width:70,render:function(e){return e?Object(o.d)(e):""}},soPhanAn:{id:"soPhanAn",name:"SP \u0103n",className:"text-small",align:"right",width:60,render:function(e){return e?Object(o.d)(e):""}},tongPhan:{id:"tongPhan",name:"T\u1ed5ng p.\u0103n",className:"text-small font-weight-bold",align:"right",width:70,render:function(e){return e?Object(o.d)(e):""}},thanhTien:{id:"thanhTien",name:"Th\xe0nh ti\u1ec1n",align:"center",className:"text-small",width:110,render:function(e){return e?i.a.createElement("div",{className:"float-right"},Object(o.d)(e)):""}},ghiChu:{id:"ghiChu",name:"Ghi ch\xfa",className:"text-small",width:230,render:function(e,n,t,a){var o,l=a.datas,c=(null===l||void 0===l||null===(o=l[n.id])||void 0===o?void 0:o.customers)||{},d=Object.keys(c).map((function(e){var n=null===c||void 0===c?void 0:c[e];return{name:null===n||void 0===n?void 0:n.name,tongPhan:null===n||void 0===n?void 0:n.tongPhan,ghiChu:null===n||void 0===n?void 0:n.ghiChu}}));return i.a.createElement("div",null,i.a.createElement("div",null,d.filter((function(e){return null===e||void 0===e?void 0:e.tongPhan})).map((function(e){return"".concat(e.name,": ").concat(e.tongPhan||"--")})).join(", ")),d.filter((function(e){return null===e||void 0===e?void 0:e.ghiChu})).map((function(e){return i.a.createElement("div",{key:e.name,className:"font-weight-bold"},"".concat(e.name,": ").concat(null===e||void 0===e?void 0:e.ghiChu))})))}}}},1073:function(e,n,t){"use strict";var a=t(3),i=t(23),o=t(36),l=t(33),c=t(32),d=t(0),r=t.n(d),u=t(223),s=t(41),h=t(1065),m=t(16),v=t.n(m),f=(t(258),t(82)),g=t(102),p=t(192),b=t(11),C=t(7),I=t(466),P=t(27),M=t(34),E=t(143),O=Object(d.memo)((function(e){var n,t,a,i=e.cellId,o=e.row,l=e.history,c=e.dayId,d=e.recipeKindId,u=e.onSelect,s=e.onDelete,h=e.visibleCost,m=e.shiftConfig,v=e.customerGroup,f=e.nguyenLieusTrongMonAn,g=e.thucDonsDatas,p=e.isView,b=e.isAfter,I=e.state.nguyenLieus,O=r.a.useMemo((function(){return new P.a}),[]),D=r.a.useMemo((function(){return new E.b}),[]),T=null===g||void 0===g||null===(n=g[c])||void 0===n||null===(t=n.kindIds)||void 0===t||null===(a=t["".concat(d)])||void 0===a?void 0:a.recipeId,w=null===m||void 0===m?void 0:m.id,y=function(e){e.stopPropagation(),window.confirm("X\xe1c nh\u1eadn x\xf3a ".concat(T))&&s(d,c)},j=r.a.useCallback((function(){var e=(null===f||void 0===f?void 0:f[T])||[];if(0===e.length||!h)return null;var n={nguyenLieus:e},t=(null===v||void 0===v?void 0:v.giaPhanAn)||0,a=O.getRecipePrice(n,I);return r.a.createElement("span",{className:"cost-style"},"(".concat(Object(C.j)(a,t),"%)"))}),[T,f,v,I,h,O]);return r.a.createElement("div",{id:i,className:["recipe-style",T?"":"text-center"].join(" "),style:{overflowY:"auto",fontSize:"14px"},onClick:function(){if(b||p)return null;var e=(null===o||void 0===o?void 0:o.isMonPhu)||!1,n=[[M.c.MODAL_ID,M.a.selectRecipe.id],[M.c.SHIFT_ID,w],[M.c.KIND_ID,d],[M.c.DAY_ID,c],[M.c.IS_MON_PHU,e],[M.c.RECIPE_ID,T]];D.pushURL(l,n),u&&u()}},j()," ",T||(T?r.a.createElement("span",{className:"text-black-50"},"Thi\u1ebfu ".concat(T)):b?"":"--")," ",p||b?null:T&&r.a.createElement("div",{className:"delete-icon",onClick:y},r.a.createElement("i",{className:"fa fa-close"})))}));O.defaultProps={onDelete:b.noop,showSearch:!0,classNames:[],style:{},visibleCost:!0,coSoState:{}};var D=Object(p.a)(f.o,Object(g.b)((function(){return{}}),{getRecipePrice:I.b}))(O),T=t(13),w=function(e){Object(l.a)(t,e);var n=Object(c.a)(t);function t(e){var a;return Object(i.a)(this,t),(a=n.call(this,e)).tableColumns=[h.a.name],a.duTruItemColumns=[h.a.loaiMon,h.a.tenMon,h.a.giaMon,h.a.soPhanThem,h.a.soPhanAn,h.a.thanhTien,h.a.ghiChu],a}return Object(o.a)(t,[{key:"getTableColumns",value:function(e){var n=this,t=e.yearId,i=e.weekId,o=e.onDelete,l=e.state,c=e.isView;if(!i)return[];var d=this.tableColumns.map((function(t){return n.getGeneralFields(t,e)})),u=Array(7).fill(1).reduce((function(n,d,u){var s=d+u,h=Object(C.o)()===T.l.admin,m=v()(t,"YYYY").week(i).day(d+u),f=m.format("dddd"),g=m.format("DD/MM"),p=v()().format("DD-MM-YYYY")===m.format("DD-MM-YYYY"),b=v()().subtract(1,"day").isAfter(m),I=p?{border:"1px solid lightblue"}:{};h&&(b=!1);var P={id:s,name:"".concat(f," (").concat(g,")"),width:160,align:"center",render:function(n,t,a){var i="shift".concat("-",t.id,"-").concat(s);return r.a.createElement("div",{style:I},r.a.createElement(D,Object.assign({},e,{isView:c,state:l,row:t,cellId:i,index:a,dayId:"".concat(f).toLowerCase(),isAfter:b,style:{fontSize:"13px",padding:"3px",height:"40px"},recipeKindId:t.id,onDelete:o})))}};return[].concat(Object(a.a)(n),[P])}),[]).map((function(t){return n.getGeneralFields(t,e)}));return d=[].concat(Object(a.a)(d),Object(a.a)(u))}},{key:"getDuTruItemColumns",value:function(e){var n=this;return this.duTruItemColumns.map((function(t){return n.getGeneralFields(t,e)}))}}]),t}(u.a);w.rootRefs=[].concat(Object(a.a)(s.a.rootRefs),["duTru","bepAnChuyenDi"]);n.a=w},1128:function(e,n,t){},1140:function(e,n,t){"use strict";t.r(n);var a=t(9),i=t(1),o=t(3),l=t(5),c=(t(1068),t(0)),d=t.n(c),r=t(82),u=t(1041),s=t(256),h=t(11),m=t(1064),v=t(1067),f=t(56),g=t(41),p=t(7),b=function(e){var n,t=e.shiftConfig,a=e.isInput,i=e.setIsInput,o=e.tongHopOfShifts,l=t.id,c=(null===o||void 0===o||null===(n=o[l])||void 0===n?void 0:n.tongPhanAn)||0,r=t.id===a.shiftId;return d.a.createElement("div",{className:"display-4 mt-1 kind-title"},"".concat(t.name," - ").concat(Object(p.d)(c)," ph\u1ea7n"),d.a.createElement("button",{className:["btn btn-sm ml-1 mb-1",r?"btn-warning":"btn-outline-warning"].join(" "),onClick:function(){i(r?{}:{shiftId:t.id,type:"soPhanAn"})}},"Edit"))};b.defaultProps={userConfig:{}};var C=Object(r.o)(b),I=t(1073),P=t(27),M=function(e){var n=e.rowDatas.reduce((function(e,n){var t=((null===e||void 0===e?void 0:e.thanhTien)||0)+((null===n||void 0===n?void 0:n.thanhTien)||0);return Object(i.a)(Object(i.a)({},e),{},{soPhanAn:((null===e||void 0===e?void 0:e.soPhanAn)||0)+((null===n||void 0===n?void 0:n.soPhanAn)||0),soPhanThem:((null===e||void 0===e?void 0:e.soPhanThem)||0)+((null===n||void 0===n?void 0:n.soPhanThem)||0),thanhTien:Math.round(t)})}),{});return d.a.createElement(u.a.Summary.Row,null,d.a.createElement(u.a.Summary.Cell,{colSpan:6},d.a.createElement("div",{className:"text-center text-small font-weight-bold text-dark"},"T\u1ed5ng")),d.a.createElement(u.a.Summary.Cell,{colSpan:1},d.a.createElement("div",{className:"font-weight-bold  text-small text-danger float-right"},Object(p.d)(n.thanhTien))),d.a.createElement(u.a.Summary.Cell,{colSpan:1}))},E={soMonMan:"S\u1ed1 m\xf3n m\u1eb7n",soMonChay:"S\u1ed1 m\xf3n chay",soMonCT:"S\u1ed1 m\xf3n CT",soMonNuoc:"S\u1ed1 m\xf3n n\u01b0\u1edbc",tongPhan:"T\u1ed5ng ph\u1ea7n"},O=function(e){var n,t=e.dayTongHopData,a=e.isEditDutru,i=e.tongHopOfShifts,r=e.shiftId,s=e.customerGroup,h=(e.soMonMan,(null===i||void 0===i||null===(n=i[r])||void 0===n?void 0:n.tongPhanAn)||0),m=(null===t||void 0===t?void 0:t.tongPhan)||0,v=(null===s||void 0===s?void 0:s.giaPhanAn)||0,f=h*v,g=Object(c.useState)([]),b=Object(l.a)(g,2),C=b[0],I=b[1];Object(c.useEffect)((function(){var e=[];t&&(e=(e=["soMonMan","soMonChay","soMonCT","soMonNuoc","tongPhan"].reduce((function(e,n){var a=(null===t||void 0===t?void 0:t[n])||0,i=a*v,l={loaiMon:n,soPhan:a,cost:Math.round(i/f*100*10)/10};return[].concat(Object(o.a)(e),[l])}),[])).filter((function(e){return e.soPhan>0}))),I(e)}),[t,i]);var P=[{dataIndex:"loaiMon",title:"Lo\u1ea1i m\xf3n",width:110,className:" text-small",render:function(e,n){return"tongPhan"===n.loaiMon?d.a.createElement("div",{className:"font-weight-bold"},(null===E||void 0===E?void 0:E[e])||""):(null===E||void 0===E?void 0:E[e])||""}},{dataIndex:"soPhan",title:"S\u1ed1 ph\u1ea7n",className:" text-small",render:function(e,n){return"tongPhan"===n.loaiMon?d.a.createElement("div",{className:"float-right font-weight-bold"},Object(p.d)(e)):d.a.createElement("div",{className:"float-right"},Object(p.d)(e))},width:70},{dataIndex:"cost",title:"Cost",width:60,className:" text-small",render:function(e,n){return"tongPhan"===n.loaiMon?d.a.createElement("small",{className:"float-right font-weight-bold"},h-m):d.a.createElement("small",{className:"float-right text-danger font-weight-bold"},e,"%")}}];return a&&d.a.createElement("div",null,d.a.createElement("div",{className:"font-weight-bold text-center text-danger mb-2"},"T\u1ed5ng h\u1ee3p s\u1ed1 ph\u1ea7n"),d.a.createElement(u.a,{rowKey:"loaiMon",columns:P,dataSource:C,pagination:!1,scroll:{x:240}}))};O.defaultProps={isEditDutru:!0,isHide:!1,shiftDuTruData:{},setHide:function(){}};var D=O,T=t(23),w=t(36),y={giaPhanAn:{id:"giaPhanAn",name:"Gi\xe1 ph\u1ea7n \u0103n",width:120,required:!0},gas:{id:"gas",name:"Gas",width:100,required:!0},giaVi:{id:"giaVi",name:"Gia v\u1ecb",width:100,required:!0},gao:{id:"gao",name:"G\u1ea1o",width:100,required:!0},dinhLuongGao:{id:"dinhLuongGao",name:"\u0110L g\u1ea1o",width:100,required:!0},vanChuyen:{id:"vanChuyen",name:"V\u1eadn chuy\u1ec3n",width:100},chiPhiKhac:{id:"chiPhiKhac",name:"CP kh\xe1c",width:100}},j=function(){function e(){Object(T.a)(this,e),this.constants=y,this.innputChiPhiCoDinhFields=[y.giaPhanAn,y.gas,y.giaVi,y.gao,y.dinhLuongGao,y.vanChuyen,y.chiPhiKhac],this.chiPhiCoDinhFields=[y.gas,y.giaVi,y.vanChuyen,y.chiPhiKhac],this.chiPhiCoDinhViewFields=[y.gas,y.giaVi,y.gao,y.vanChuyen,y.chiPhiKhac]}return Object(w.a)(e,[{key:"getChiPhiCoDinh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=(null===n||void 0===n?void 0:n.tongPhan)||0,a=this.chiPhiCoDinhFields.reduce((function(n,t){return n+((null===e||void 0===e?void 0:e[t.id])||0)}),0),i=(null===e||void 0===e?void 0:e[this.constants.gao.id])||0,o=(null===e||void 0===e?void 0:e[this.constants.dinhLuongGao.id])||0,l=Math.round(o/100)/10,c=i*l;return(a+c)*t}}]),e}(),N=t(34),S=t(143),x=new j,A=new S.b,L={chiPhiCoDinh:"CP c\u1ed1 \u0111\u1ecbnh",chiPhiNguyenVatLieu:"CP NVL",tongChiPhi:"T\u1ed5ng CP",doanhThu:"Doanh Thu"},k=function(e){var n=e.history,t=e.dayTongHopData,a=e.isEditDutru,o=e.dataSource,r=e.customerGroup,s=e.shiftConfig,h=e.tongHopOfShifts,m=s.id,v=Object(c.useState)([]),f=Object(l.a)(v,2),g=f[0],b=f[1],C=Object(c.useState)(0),I=Object(l.a)(C,2),P=I[0],M=I[1],E=Object(c.useState)(0),O=Object(l.a)(E,2),D=O[0],T=O[1];Object(c.useEffect)((function(){var e,n=D+P,t=((null===r||void 0===r?void 0:r.giaPhanAn)||0)*((null===h||void 0===h||null===(e=h[m])||void 0===e?void 0:e.tongPhanAn)||0),a=[{loaiChiPhi:"chiPhiCoDinh",tien:P||"",cost:n&&P?Math.round(P/n*100*100)/100:""},{loaiChiPhi:"chiPhiNguyenVatLieu",tien:D||"",cost:D&&n?Math.round(D/n*100*100)/100:""},{loaiChiPhi:"tongChiPhi",tien:n||"",cost:n&&t?Math.round(n/t*100*100)/100:""},{loaiChiPhi:"doanhThu",tien:t||"",cost:""}];b(a)}),[P,D,r,t,h]),Object(c.useEffect)((function(){if(r&&t){var e=(null===t||void 0===t?void 0:t.tongPhan)||0,n=x.getChiPhiCoDinh(r,{tongPhan:e});M(n)}}),[r,t]),Object(c.useEffect)((function(){var e=o.reduce((function(e,n){var t=((null===e||void 0===e?void 0:e.thanhTien)||0)+((null===n||void 0===n?void 0:n.thanhTien)||0);return Object(i.a)(Object(i.a)({},e),{},{thanhTien:Math.round(t)})}),{});T((null===e||void 0===e?void 0:e.thanhTien)||0)}),[o,h]);var w=[{dataIndex:"loaiChiPhi",title:"Lo\u1ea1i CP",width:120,className:" text-small",render:function(e){switch(e){case"chiPhiCoDinh":return d.a.createElement("div",{style:{textDecoration:"underline",color:"blue"},className:"hoverClass",onClick:function(){var e=[[N.c.MODAL_ID,N.a.openChiPhiCoDinhModal.id],[N.c.SHIFT_ID,s.id]];A.pushURL(n,e)}},(null===L||void 0===L?void 0:L[e])||"");case"tongChiPhi":case"doanhThu":return d.a.createElement("div",{className:"font-weight-bold"},null===L||void 0===L?void 0:L[e]);default:return d.a.createElement("div",null,(null===L||void 0===L?void 0:L[e])||"")}}},{dataIndex:"tien",title:"Ti\u1ec1n",className:" text-small",render:function(e,n){return"tongChiPhi"===n.loaiChiPhi||"doanhThu"===n.loaiChiPhi?d.a.createElement("div",{className:"float-right font-weight-bold"},Object(p.d)(e)):d.a.createElement("div",{className:"float-right"},Object(p.d)(e))},width:70},{dataIndex:"cost",title:"Cost",width:60,className:" text-small",render:function(e){return e&&d.a.createElement("sub",{className:"text-danger font-weight-bold"},e,"%")}}];return a&&d.a.createElement("div",{className:"mt-2"},d.a.createElement("div",{className:"font-weight-bold text-center text-danger mb-2"},"T\u1ed5ng h\u1ee3p chi ph\xed"),d.a.createElement(u.a,{rowKey:"loaiChiPhi",columns:w,dataSource:g,pagination:!1,scroll:{x:250}}))};k.defaultProps={isEditDutru:!0,isHide:!1,shiftDuTruData:{},dataSource:[]};var G=k,_=(t(1128),t(13)),H=t(149),K=t(610),V=t(1017),R=t(664),U=K.b.Item,F=new S.b,Y=new j,z=function(e){var n=e.history,t=e.location,a=e.dayTongHopData,i=e.coSoId,o=e.shiftConfig,r=e.customerGroup,u=F.getQuery(t,N.c.MODAL_ID),s=F.getQuery(t,N.c.SHIFT_ID),h=Y.chiPhiCoDinhViewFields,m=Object(c.useState)(!1),v=Object(l.a)(m,2),f=v[0],g=v[1];Object(c.useEffect)((function(){var e=u===N.a.openChiPhiCoDinhModal.id&&"".concat(o.id)==="".concat(s);g(!!e)}),[u,o]);var b=(null===a||void 0===a?void 0:a.tongPhan)||0,C=(null===a||void 0===a?void 0:a.chiPhiCoDinh)||0,I=((null===a||void 0===a?void 0:a.soMonMan)||0)+((null===a||void 0===a?void 0:a.soMonChay)||0);return d.a.createElement(H.d,{title:d.a.createElement("div",{className:"text-dark"},d.a.createElement("i",{className:"fa fa-sliders mr-2"}),d.a.createElement("strong",null,N.a.openChiPhiCoDinhModal.name," - ",_.k.getName(i))),isOpen:f,onCancel:function(){return n.push("?")},centered:!0,width:"650px"},d.a.createElement("div",{className:"mb-3"},d.a.createElement("strong",null,"T\u1ed5ng ph\u1ea7n: ",Object(p.d)(b),", T\u1ed5ng ph\u1ea7n c\u01a1m: ",Object(p.d)(I)," - Chi ph\xed c\u1ed1 \u0111\u1ecbnh: ",Object(p.d)(C))),d.a.createElement(K.b,{bordered:!0,column:1,size:"small"},h.map((function(e){var n=(null===r||void 0===r?void 0:r[e.id])||0,t="".concat(e.name," = ").concat(Object(p.d)(n)," x ").concat(Object(p.d)(b)," ph\u1ea7n"),a=b*n;if("gao"===e.id){var i=n,o=(null===r||void 0===r?void 0:r.dinhLuongGao)||0,l=Math.round(o/100)/10;a=(n*=l)*I,t="Gi\xe1 ".concat(e.name," x \u0110L g\u1ea1o = ").concat(Object(p.d)(i)," x ").concat(l," x ").concat(Object(p.d)(I)," ph\u1ea7n")}var c=Object(p.s)(a,C);return d.a.createElement(U,{key:e.id,label:t,span:1},d.a.createElement(V.a,{gutter:5},d.a.createElement(R.a,{span:12,className:"font-weight-bold"},d.a.createElement("div",{className:"float-right"},Object(p.d)(a))),d.a.createElement(R.a,{span:12},d.a.createElement("small",{className:"text-danger font-weight-bold"},"(",c,"%)"))))}))))};z.defaultProps={};var q=Object(r.o)(z),X=t(223),B=t(100),J=(t(16),d.a.lazy((function(){return t.e(24).then(t.bind(null,1136))})));n.default=Object(r.o)((function(e){var n=e.shiftConfig,t=e.recipeKinds,r=e.nguyenLieusTrongMonAn,p=e.soMonMan,b=e.customerGroup,E=e.tongHopOfShifts,O=e.isInput,T=e.setIsInput,w=e.duLieuChungState.nguyenLieus,y=d.a.useMemo((function(){return new I.a}),[]),N=d.a.useMemo((function(){return new g.a}),[]),S=d.a.useMemo((function(){return new P.a}),[]),x=d.a.useMemo((function(){return new j}),[]),A=e.userConfig,L=e.userConfigHandle,k=A.coSoId,_=A.yearId,H=A.weekId,K=A.customerId,V=A.dayId,R=n.id,U=Object(c.useContext)(f.a),F=U.firebase,Y=U.duTruDispatch,z=U.duTruSettingDispatch,Q=Object(c.useContext)(f.b),W=Q.duTruState,Z=Q.recipeState,$=d.a.useMemo((function(){return(null===Z||void 0===Z?void 0:Z.recipeDatas)||{}}),[Z]),ee=null===W||void 0===W?void 0:W["thucDonDuTruData/".concat(R)],ne=null===W||void 0===W?void 0:W["thucDonData/".concat(R)],te=null===W||void 0===W?void 0:W["tongHopDuTruData/".concat(K,"/").concat(R)],ae=null===W||void 0===W?void 0:W.isLoading,ie=N.getDuTruConfigConstantsArray(),oe="1592732051173"===K,le=Object(c.useState)(!1),ce=Object(l.a)(le,2),de=ce[0],re=ce[1],ue=Object(c.useState)([]),se=Object(l.a)(ue,2),he=se[0],me=se[1],ve=Object(c.useState)(null),fe=Object(l.a)(ve,2),ge=fe[0],pe=fe[1];d.a.useEffect((function(){if(k&&K){var e=[v.a.DUTRU.SETTINGS.CAUHINH_DUTRU,k,K,n.id];F.db.ref(e.join("/")).once("value",(function(e){var n=e.val();pe(n)}))}}),[n,k,K]),d.a.useEffect((function(){var e=[];ge&&ee&&ne&&V&&w&&r&&(e=(e=ie.reduce((function(e,n){var a=n.id,i=null===ge||void 0===ge?void 0:ge[n.id],l=((null===i||void 0===i?void 0:i.values)||[]).map((function(e){var n,i=null===ee||void 0===ee?void 0:ee[e],o=null===ne||void 0===ne?void 0:ne[e],l=null===o||void 0===o?void 0:o.recipeId,c=(null===i||void 0===i?void 0:i.soPhanAn)||0,d=(null===i||void 0===i?void 0:i.soPhanThem)||0,u=c+d,s=(null===i||void 0===i?void 0:i.ghiChu)||"",h=(null===i||void 0===i?void 0:i.dieuChinh)||{},m=(null===r||void 0===r?void 0:r[l])||[],v=S.getRecipePrice({nguyenLieus:m},w,h,[l]),f=u*v;return{id:"".concat(e),name:(null===t||void 0===t||null===(n=t[e])||void 0===n?void 0:n.name)||e,loaiMonId:a,recipeId:l,tenMon:l,giaMon:v,thanhTien:f,ghiChu:s,soPhanThem:d,soPhanAn:c,tongPhan:u,dieuChinh:h,chiPhiNVL:f}}));return[].concat(Object(o.a)(e),Object(o.a)(l))}),[])).filter((function(e){return e.tenMon}))),me(e)}),[ge,ee,ne,V,w,r]),d.a.useEffect((function(){var e={},n=[k,_,H,"shiftIds",R,"customerIds",K,V,"kindIds"];return k&&_&&H&&R&&K&&V&&(Y({type:"start"}),m.a.getThucDonDuTru(n,{shiftId:R},e)(U)),function(){e[R]&&e[R].off()}}),[k,_,H,R,K,V]),d.a.useEffect((function(){var e={},n=[k,_,H,"shiftIds",R,"thucDons",V,"kindIds"];return k&&_&&H&&R&&V&&(Y({type:"start"}),m.a.getThucDon(n,{shiftId:R},e)(U)),function(){e[R]&&e[R].off()}}),[k,_,H,R,V]),d.a.useEffect((function(){if(ee&&ge&&K&&b&&he.length>0){var e=be(ee,he);m.a.updateTongHopData(K,R,e)(U)}else m.a.updateTongHopData(K,R,null)(U)}),[K,ee,ge,b,he]),d.a.useEffect((function(){T({})}),[V,k,K,_,H]),d.a.useEffect((function(){return function(){Y({type:"reset"}),z({type:"reset"})}}),[]);var be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t={dayDuTruData:e,dayId:V,dayThucDonData:ne,recipeDatas:$,soMonMan:p},a=X.a.getSoTongPhan(ge,t),i=x.getChiPhiCoDinh(b,{tongPhan:a}),o=n.reduce((function(e,n){return e+(n.chiPhiNVL||0)}),0),l=i+o,c={soMonMan:X.a.getSoMonMan(ge,t),soMonMan_CoCanh:X.a.getSoMonMan_CoCanh(ge,t),soMonNuocChay:X.a.getSoMonNuocChay(ge,t),soMonCT_CoCom:X.a.getSoMonCT_CoCom(ge,t),soMonChay:X.a.getSoMonChay(ge,t),soMonCT:X.a.getSoMonCT(ge,t),soMonNuoc:X.a.getSoMonNuoc(ge,t),soMonCanh:X.a.getSoMonCanh(ge,t),soMonXao:X.a.getSoMonXao(ge,t),soMonTrangMieng:X.a.getSoMonTrangMieng(ge,t),tongPhan:a,chiPhiCoDinh:i,chiPhiNVL:o,tongChiPhi:l};return c},Ce=function(e,n){var t,l,c,d=null===n||void 0===n?void 0:n.recipeKindId,r=null===n||void 0===n?void 0:n.type,u=[k,_,H,"shiftIds",R,"customerIds",K,V,"kindIds",d,r],s=null===ee||void 0===ee||null===(t=ee[d])||void 0===t?void 0:t[r];switch(r){case"ghiChu":s=s||"";break;case"soPhanAn":case"soPhanThem":s=s||0;break;case"dieuChinh":var v=null===n||void 0===n?void 0:n.nguyenLieuId,f=null===n||void 0===n?void 0:n.recipeId;u=[].concat(Object(o.a)(u),[f,v]),s=(null===(l=s)||void 0===l||null===(c=l[f])||void 0===c?void 0:c[v])||0}var g=!Object(h.isEqual)(s,e),p=function(){re(!1)};if(d&&r&&g)switch(Y({type:"start"}),re(!0),r){case"soPhanAn":case"soPhanThem":var b=Object(i.a)({},ee),C=(null===b||void 0===b?void 0:b.ghiChu)||null;oe&&!C&&(C="x1:, x2:, ddk:, mil:, ryobi:, mp4:"),Object(h.set)(b,[d,r],e);var I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(null===e||void 0===e?void 0:e.soMonCanh)||0,t=(null===e||void 0===e?void 0:e.soMonMan_CoCanh)||0,o=(null===e||void 0===e?void 0:e.soMonNuocChay)||0,l=(null===e||void 0===e?void 0:e.soMonCT_CoCom)||0,c=(null===e||void 0===e?void 0:e.soMonXao)||0,d=(null===e||void 0===e?void 0:e.soMonTrangMieng)||0,r=n-t-o+l,u=c-o,s=[{id:B.b.monCanhConfig.id,soPhanAn:r===1/0?0:r},{id:B.b.monXaoConfig.id,soPhanAn:u===1/0?0:u},{id:B.b.dessertConfig.id,soPhanAn:d===1/0?0:d}];return s.reduce((function(e,n){var t,o,l=null===(t=ge[n.id])||void 0===t||null===(o=t.values)||void 0===o?void 0:o[0],c=(null===ee||void 0===ee?void 0:ee[l])||{},d=(null===c||void 0===c?void 0:c.ghiChu)||null;oe&&!d&&(d="x1:,x2:,ddk:,mil:");var r=Object(i.a)(Object(i.a)({},c),{},{ghiChu:d,soPhanAn:n.soPhanAn});return Object(i.a)(Object(i.a)({},e),{},Object(a.a)({},l,r))}),{})}(be(b,[])),P=null===b||void 0===b?void 0:b[d],M=Object(i.a)(Object(i.a)({},I),{},Object(a.a)({},d,Object(i.a)({ghiChu:C},P))),E=[k,_,H,"shiftIds",R,"customerIds",K,V,"kindIds"];m.a.updateThucDonDuTru(E,M,p,{})(U);break;case"ghiChu":case"dieuChinh":m.a.setThucDonDuTru(u,e,p)(U)}},Ie=y.getDuTruItemColumns(Object(i.a)(Object(i.a)({},e),{},{dayId:V,giaPhanAn:(null===b||void 0===b?void 0:b.giaPhanAn)||0,customerId:K,customerGroupId:b.id,coSoId:k,shiftId:R,isInput:O,setIsInput:T,onUpdate:Ce}));return he.length>0&&d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"row duTruItem mb-3"},d.a.createElement("div",{className:"col-lg-9"},d.a.createElement(C,{userConfigHandle:L,userConfig:A,tongHopOfShifts:E,shiftConfig:n,isInput:O,setIsInput:T}),d.a.createElement("div",{className:"mb-2"},d.a.createElement(u.a,{size:"small",loading:ae||de,rowKey:"id",bordered:!0,columns:Ie,dataSource:he,pagination:!1,expandAll:!0,scroll:{x:800},expandable:{expandedRowRender:function(e){return d.a.createElement(d.a.Suspense,{fallback:d.a.createElement(s.a,{className:"osac-spin"})},d.a.createElement(J,{record:e,nguyenLieus:w,nguyenLieusTrongMonAn:r,shiftId:R,isInput:O,setIsInput:T,onUpdate:Ce}))}},summary:function(e){return d.a.createElement(M,{rowDatas:e})}}))),d.a.createElement("div",{className:"col-lg-3"},d.a.createElement(D,{shiftId:R,customerGroup:b,dayTongHopData:te,tongHopOfShifts:E}),d.a.createElement(G,Object.assign({},e,{shiftConfig:n,dayId:V,coSoId:k,customerId:K,yearId:_,weekId:H,dayTongHopData:te,dataSource:he,customerGroup:b,tongHopOfShifts:E})))),d.a.createElement(q,Object.assign({},e,{shiftConfig:n,customerGroup:b,dayTongHopData:te,dayId:V,coSoId:k})))}))}}]);