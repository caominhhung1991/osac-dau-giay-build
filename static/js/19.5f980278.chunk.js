(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[19],{1143:function(e,t,n){"use strict";n.r(t);var a=n(3),o=n(1),r=n(5),c=n(0),u=n.n(c),i=n(22),l=n(28),d=n(260),s=n(161),m=n(30),b=n(23),g=n(36),f=n(337),v=function(){function e(t){Object(b.a)(this,e),this.donDaNhanData=t,this.datasArray=(null===t||void 0===t?void 0:t.datas)||[]}return Object(g.a)(e,[{key:"getData",value:function(){var e=this,t=this.getDatasArray(),n=this.getTongTien(),a=f.a.getDonDaNhanInputFields().reduce((function(t,n){var a;return t+((null===(a=e.donDaNhanData)||void 0===a?void 0:a[null===n||void 0===n?void 0:n.id])||0)}),0);return Object(o.a)(Object(o.a)({},this.donDaNhanData),{},{datas:t,tongTien:n+a,tongTienCom:n})}},{key:"getThanhTien",value:function(e){var t=e.soLuongThuc,n=void 0===t?0:t,a=e.price;return n*(void 0===a?0:a)}},{key:"getDatasArray",value:function(){var e=this;return this.datasArray.map((function(t){var n=e.getThanhTien(t);return Object(o.a)(Object(o.a)({},t),{},{thanhTien:n})}))}},{key:"getTongTien",value:function(){var e,t=this;return((null===(e=this.donDaNhanData)||void 0===e?void 0:e.datas)||[]).reduce((function(e,n){return e+t.getThanhTien(n)}),0)}}]),e}(),h=n(9),p=n(7),C=n(65),O=Object(c.memo)((function(e){var t=e.pageData,n=e.emptyColSpan,r=e.tongColSpan,c=u.a.useMemo((function(){return f.a.getDonDaNhanSummaryFields()}),[]),i=u.a.useMemo((function(){return[{id:"tong",colSpan:r||3,cellClassName:"font-weight-bold text-danger text-small text-center"}].concat(Object(a.a)(c.map((function(e){return{id:e.id,cellClassName:"font-weight-bold text-danger text-small text-right"}}))),[{id:"empty",colSpan:n||3}])}),[c]),l=u.a.useMemo((function(){return t?t.reduce((function(e,t){return c.reduce((function(e,n){var a=n.id,r=((null===e||void 0===e?void 0:e[a])||0)+((null===t||void 0===t?void 0:t[a])||0);return Object(o.a)(Object(o.a)({},e),{},Object(h.a)({},a,r))}),e)}),{}):{}}),[c,t]),d=u.a.useMemo((function(){return[{tong:"T\u1ed5ng"}].concat(Object(a.a)(c.map((function(e){var t=e.id,n=(null===l||void 0===l?void 0:l[t])||0;return Object(h.a)({},t,Object(p.f)(n))}))))}),[c,l]);return u.a.createElement(C.b,{columns:i,dataSource:d})})),j=u.a.memo((function(e){var t=e.onOk,n=e.state,a=e.datasource,c=u.a.useState(null),i=Object(r.a)(c,2),l=i[0],d=i[1],s=u.a.useMemo((function(){var e=a.reduce((function(e,t){var n=t.nhaCungCapId;return Object(o.a)(Object(o.a)({},e),{},Object(h.a)({},n,!0))}),{}),t=(null===n||void 0===n?void 0:n.vendorsArray)||[];return t=t.filter((function(t){var n=t.id;return!(null===e||void 0===e?void 0:e[n])}))}),[null===n||void 0===n?void 0:n.vendorsArray,a]),b=Object(m.p)({dataArray:s||[],selectedId:l,onSelect:function(e){return d(e)},style:{width:"100%"},autoFocus:!0}),g=Object(r.a)(b,1)[0];return u.a.createElement("div",null,g.getRender(),u.a.createElement("div",{className:"mt-1 align-right"},u.a.createElement("button",{disabled:!l,className:"btn btn-md btn-success",onClick:function(){return t(l)}},"Ok")))})),D=n(11),N=n(276),y=n(332),w=Object(c.memo)((function(e){var t,n,c=e.state,b=e.actions,g=Object(N.a)(),f=Object(N.b)((function(e){return e.nhaCungCap})).nhaCungCapDonHangFilter,h=c.donDaGiaosArray,C=c.ngayGiaoFilter,w=c.loading,T=c.moment,k=Object(m.q)(),E=Object(r.a)(k,1)[0],S=Object(m.d)({defaultTime:T().subtract(1,"day")}),A=Object(r.a)(S,2),M=A[0],H=A[1];u.a.useEffect((function(){return b.getDonDatHangComDaGiaos(H),function(){return b.stopListenDonDatHang()}}),[M]);var G=u.a.useMemo((function(){return h?h.map((function(e){return new v(e).getData()})):[]}),[h]);u.a.useEffect((function(){if(G){var e=Object(i.l)(G,"tenNhaCungCap","tenNhaCungCap"),t=Object(i.f)(e,"tenNhaCungCap","tenNhaCungCap","tenNhaCungCap");g(Object(y.c)(t));var n=Object(i.l)(G,"ngayGiaoValue","name"),a=Object(i.f)(n,"ngayGiaoValue","name","name");b.setState({ngayGiaoFilter:a})}}),[G]);var x=function(e,t){b.khoaDonHangCom(e,t)},L=u.a.useMemo((function(){return(new s.a).getTableColumns({status:"donDaNhan",onLockItem:x}).map((function(e){return"tenNhaCungCap"===e.id?Object(o.a)(Object(o.a)({},e),f):"ngayGiaoValue"===e.id?Object(o.a)(Object(o.a)({},e),C):e}))}),[f,C]),B=Object(l.useModal)(),F=u.a.useMemo((function(){var e=((null===B||void 0===B?void 0:B.selectedData)||{}).nhaCungCapName;return{title:"\u0111\u01a1n h\xe0ng ".concat(e).toUpperCase(),Body:function(e){return u.a.createElement(d.a,e)},footer:!1,width:950,onCancel:function(){return b.setState({nguyenLieuDataSource:null})},maskClosable:!0}}),[B.selectedData]),R=Object(l.useModal)(),I=u.a.useMemo((function(){return{title:"Th\xeam \u0111\u01a1n h\xe0ng tr\u1ed1ng t\u1eeb NCC".toUpperCase(),Body:function(e){return u.a.createElement(j,e)},width:950,onCancel:D.noop,footer:!1,maskClosable:!1,bodyProps:{state:c,datasource:G,onOk:function(e){return b.createDonHangNCCRong(e,H)}}}}),[R.selectedData,G]),V={breadcrumbs:Object(a.a)((null===e||void 0===e||null===(t=e.breadcrumb)||void 0===t?void 0:t.breadcrumbs)||[]),buttons:[].concat(Object(a.a)((null===e||void 0===e||null===(n=e.breadcrumb)||void 0===n?void 0:n.buttons)||[]),[{element:E.getSettingIcon()}])};return u.a.createElement("div",null,"Admin"===Object(p.o)()&&u.a.createElement("button",{className:"btn btn-sm btn-danger mr-1",onClick:function(){var e=window.prompt("Nh\u1eadp NCC id");console.log(e),b.getAndSetDonDatHangByNCCHandle(e)}},"L\u1ea5y NL t\u1ed5ng h\u1ee3p SL"),"Admin"===Object(p.o)()&&u.a.createElement("button",{className:"btn btn-sm btn-danger mr-1",onClick:function(){var e=window.prompt("Nh\u1eadp NCC id"),t=window.prompt("Nh\u1eadp MM-YY"),n=window.prompt("Nh\u1eadp ng\xe0y d\u1eebng DD");console.log(e,t,n),n=Number(n),n=!isNaN(n)&&n,b.getDonDaNhanByNCCAndExportHandle(e,t,n)}},u.a.createElement("i",{className:"fa fa-download"})," T\u1ed5ng s\u1ed1 l\u01b0\u1ee3ng in month"),u.a.createElement(l.Breadcrumb,{breadcrumb:V}),u.a.createElement("div",{className:"mb-3"},H.getRender(),u.a.createElement("button",{className:"btn btn-sm btn-success ml-1",onClick:function(){return R.open()({})}},"Th\xeam NCC ch\u01b0a c\xf3")),u.a.createElement(l.AntTable,{rowKey:"id",bordered:!0,size:"small",dataSource:G,columns:L,rowClassName:"hoverClassBG",loading:w,settingHandle:E,onRow:function(e){return{onClick:function(){console.log(e),b.setState({donDatHangData:e}),B.open()(e)}}},summary:function(e){return u.a.createElement(O,{pageData:e})}}),B.getRender(F),R.getRender(Object(o.a)(Object(o.a)({},I),{},{state:c})))}));t.default=w}}]);