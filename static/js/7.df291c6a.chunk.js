(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[7],{1064:function(e,t,n){"use strict";var a=n(396);n.d(t,"b",(function(){return a.a}));var u=n(397);n.d(t,"a",(function(){return u.a}));var r=n(398);n.d(t,"c",(function(){return r.a}))},1067:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a={DUTRU:{URL:"thucDonDuTru",DATAS:"thucDonDuTru/datas",SETTINGS:{URL:"thucDonDuTru/settings",NHOM_KH:"thucDonDuTru/settings/nhomKhachHang",CAUHINH_DUTRU:"thucDonDuTru/settings/cauHinhDuTru",SHIFT:"thucDonDuTru/settings/shift"}},RECIPES:{URL:"recipes",DATAS:"recipes/datas",CUSTOMER_GROUP:"recipes/customerGroup"}}},1069:function(e,t,n){"use strict";var a=n(1),u=n(3),r=n(0),i=n.n(r),c=n(8),o=n.n(c),s=n(659),l=n(119),d=n(110),f=n(11),h=n(56),v=n(1064),m=function(e){var t,n,c=e.externalWrapperContainer,m=e.mode,g=e.existedCustomers,b=e.viewIds,p=e.style,O=e.userConfig,y=e.userConfigHandle,j=O.coSoId,C=O.customerId,D=O.customerIds,T=(null===y||void 0===y?void 0:y.setConfig)?y.setConfig:f.noop,E=Object(u.a)(c),H=Object(r.useContext)(h.a),S=Object(r.useContext)(h.b),A=null===S||void 0===S||null===(t=S.duTruSettingState)||void 0===t?void 0:t.khachHangs,k=null===S||void 0===S||null===(n=S.duTruSettingState)||void 0===n?void 0:n.khachHangsArray,I=i.a.useMemo((function(){return(k||[]).filter((function(e){return null===e||void 0===e?void 0:e.active}))}),[k]);Object(r.useEffect)((function(){j&&v.b.getsKhachHangsFromBepAnChuyenDi([j])(H)}),[j]);var R=i.a.useMemo((function(){return(I||[]).filter((function(e){return-1===g.indexOf("".concat(e.id))}))}),[I,g]);return i.a.useEffect((function(){if(!R.some((function(e){return"".concat(e.id)==="".concat(C)}))){var e,t=(null===R||void 0===R||null===(e=R[0])||void 0===e?void 0:e.id)||null;T(["customerId"],t)}}),[C,R]),"view"===m?i.a.createElement("div",null,b.map((function(e){var t;return i.a.createElement(s.a,{key:e},(null===A||void 0===A||null===(t=A[e])||void 0===t?void 0:t.name)||e)}))):i.a.createElement(l.a,{title:"Ch\u1ecdn kh\xe1ch h\xe0ng",className:o()(E)},"multiple"===m||"tags"===m?i.a.createElement(d.a,{value:D,style:Object(a.a)({minWidth:"140px"},p),onChange:function(e){return T(["customerIds"],e)},mode:m},R.map((function(e){return i.a.createElement(d.a.Option,{key:e.id,value:"".concat(e.id)},e.name)}))):i.a.createElement(d.a,{value:0===I.length?null:"".concat(C),style:Object(a.a)({width:"140px"},p),onChange:function(e){return T(["customerId"],e)},mode:m},I.map((function(e){return i.a.createElement(d.a.Option,{key:e.id,value:"".concat(e.id)},e.name)}))))};m.defaultProps={style:{},userConfig:{},externalWrapperContainer:[],coSoDispatch:f.noop,mode:null,isfilteredAfterSelect:!1,viewIds:[],existedCustomers:[]},t.a=m},1126:function(e,t,n){},1127:function(e,t,n){},1144:function(e,t,n){"use strict";n.r(t);var a=n(9),u=n(1),r=n(5),i=(n(1126),n(0)),c=n.n(i),o=n(3),s=(n(1127),n(463)),l=n(1017),d=n(664),f=n(110),h=n(11),v=n(1069),m=n(212),g=Array(52).fill(1).reduce((function(e,t,n){return[].concat(Object(o.a)(e),[t+n])}),[]),b=Array(10).fill(2018).reduce((function(e,t,n){return[].concat(Object(o.a)(e),[t+n])}),[]),p=function(e){var t=e.userConfig,n=e.userConfigHandle,a=t.coSoId,u=t.yearId,r=t.weekId,i=(null===n||void 0===n?void 0:n.setConfig)?n.setConfig:h.noop;return c.a.createElement(l.a,{className:"justify-content-center",gutter:[5,5]},c.a.createElement(d.a,null,c.a.createElement(s.a,{defaultCantinId:a,style:{width:"100px"},selectCantin:function(e){return i(["coSoId"],e)},manualCoSoArray:[m.a.xuongDauGiay],isCoSo:!0})),c.a.createElement(d.a,null,c.a.createElement(v.a,{userConfigHandle:n,userConfig:t})),c.a.createElement(d.a,null,c.a.createElement(f.a,{value:r,style:{width:"70px"},onChange:function(e){return i(["weekId"],e)}},g.map((function(e){return c.a.createElement(f.a.Option,{key:e,value:e},e)})))),c.a.createElement(d.a,null,c.a.createElement(f.a,{style:{width:"100px"},value:u,onChange:function(e){return i(["yearId"],e)}},b.map((function(e){return c.a.createElement(f.a.Option,{key:e,value:e},e)})))))};p.defaultProps={userConfig:{}};var O=p,y=n(256),j=n(1064),C=n(56),D=n(41),T=n(1067),E=n(460),H=n(23),S=n(36),A=function(){function e(t){Object(H.a)(this,e),this.duTruSettingState=t||{},this.loading=(null===t||void 0===t?void 0:t.loading)||!1,this.cauHinhDuTrus=(null===t||void 0===t?void 0:t.cauHinhDuTrus)||{},this.cauHinhDuTrusArray=(null===t||void 0===t?void 0:t.cauHinhDuTrusArray)||[],this.shifts=(null===t||void 0===t?void 0:t.shifts)||{},this.shiftsArray=(null===t||void 0===t?void 0:t.shiftsArray)||[],this.recipeKinds=(null===t||void 0===t?void 0:t.recipeKinds)||{},this.recipeKindsArray=(null===t||void 0===t?void 0:t.recipeKindsArray)||[],this.khachHangs=(null===t||void 0===t?void 0:t.khachHangs)||{},this.khachHangsArray=(null===t||void 0===t?void 0:t.khachHangsArray)||[]}return Object(S.a)(e,[{key:"getCauHinhDuTruTheoCa",value:function(){return this.cauHinhDuTrusArray.reduce((function(e,t){return Object.entries(t).reduce((function(e,t){var n=Object(r.a)(t,2),i=n[0],c=n[1],o=(null===e||void 0===e?void 0:e[i])||{},s=Object.entries(c).reduce((function(e,t){var n=Object(r.a)(t,2),i=(n[0],n[1]),c=((null===i||void 0===i?void 0:i.values)||[]).reduce((function(e,t){return Object(u.a)(Object(u.a)({},e),{},Object(a.a)({},t,{isOpen:!0}))}),{});return Object(u.a)(Object(u.a)({},e),c)}),o);return Object(u.a)(Object(u.a)({},e),{},Object(a.a)({},i,s))}),e)}),{})}},{key:"getConstants",value:function(){return{loading:this.loading,cauHinhDuTrus:this.cauHinhDuTrus,cauHinhDuTrusArray:this.cauHinhDuTrus,shifts:this.shifts,shiftsArray:this.shiftsArray,recipeKinds:this.recipeKinds,recipeKindsArray:this.recipeKindsArray,khachHangs:this.khachHangs,khachHangsArray:this.khachHangsArray}}}]),e}(),k=n(458),I=n(325),R=c.a.lazy((function(){return n.e(12).then(n.bind(null,1134))})),U=c.a.lazy((function(){return n.e(14).then(n.bind(null,1135))})),x=Object(i.memo)((function(e){var t=e.history,n=c.a.useMemo((function(){return new D.a}),[]),o=Object(i.useContext)(C.a),s=o.firebase,l=o.duTruSettingDispatch,d=o.duTruDispatch,f=Object(i.useContext)(C.b).duTruSettingState,v=Object(k.b)(),m=Object(r.a)(v,2),g=m[0],b=m[1],p=g.shiftsArray,H=g.khachHangsArray,S=g.cauHinhDuTrusArray,x=Object(I.a)(),w=Object(r.a)(x,1)[0],K=Object(E.a)({child:["thucDonDuTruConfig"]}),N=Object(r.a)(K,1)[0],G=(null===N||void 0===N?void 0:N.thucDonDuTruConfig)||{},M=G.coSoId,L=G.customerId,P=G.yearId,_=G.weekId,F=Object(i.useState)({}),W=Object(r.a)(F,2),B=W[0],z=W[1],J=Object(i.useState)({}),q=Object(r.a)(J,2),Q=q[0],V=q[1];Object(i.useEffect)((function(){if(M&&L){var e=[T.a.DUTRU.SETTINGS.NHOM_KH,M];s.db.ref(e.join("/")).once("value",(function(e){var t=e.val()||{},a=n.getCustomerGroup(t,L);z(a)}))}}),[M,L]),Object(i.useEffect)((function(){var e=B.id,t=null;if(e){var n=[T.a.RECIPES.CUSTOMER_GROUP,e];(t=s.db.ref(n.join("/"))).once("value",(function(e){var t=e.val()||{};V(t)}))}return function(){t&&t.off()}}),[B]),Object(i.useEffect)((function(){if(M){var e=[M];j.b.getShifts(e)(o),j.b.getsKhachHangsFromBepAnChuyenDi(e)(o),j.b.getsSetupCustomerConfig(e)(o)}}),[M]),Object(i.useEffect)((function(){if(f){var e=new A(f),t=e.getCauHinhDuTruTheoCa(),n=e.getConstants();b.setState(Object(u.a)(Object(u.a)({},n),{},{cauHinhDuTruByShifts:t}))}}),[f]),Object(i.useEffect)((function(){return l({type:"start"}),j.b.getsRecipeKind()(o),b.getNguyenLieus(),j.c.getRecipes()(o),function(){b.stopListenNguyenLieu()}}),[]);var X=Object(i.useState)({}),Y=Object(r.a)(X,2),Z=Y[0],$=Y[1];Object(i.useEffect)((function(){var e=null;if(M&&L&&P&&_){var t=[T.a.DUTRU.DATAS,M,P,_,"shiftIds"];(e=s.db.ref(t.join("/"))).on("value",(function(e){d({type:"end"});var t=e.val()||{};$(t)}))}return function(){e&&(console.log("shiftDuTrDataRef.off()"),d({type:"start"}),e.off())}}),[M,L,P,_]);var ee=Object(i.useState)({}),te=Object(r.a)(ee,2),ne=te[0],ae=te[1],ue=function(e){var t=!Object(h.get)(ne,[e],!0);ae(Object(u.a)(Object(u.a)({},ne),{},Object(a.a)({},e,t)))};return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"mt-2"},c.a.createElement(i.Suspense,{fallback:c.a.createElement(y.a,{className:"osac-spin btn"})},c.a.createElement(O,{userConfig:G,userConfigHandle:N}))),c.a.createElement("div",null,(p||[]).map((function(t){var n,a,r=t.id,o=!1===ne[null===t||void 0===t?void 0:t.id]?{display:"none"}:{},s=(null===Z||void 0===Z||null===(n=Z[r])||void 0===n?void 0:n.customerIds)||{},l=(null===s||void 0===s?void 0:s[L])||{},d=(null===Z||void 0===Z||null===(a=Z[r])||void 0===a?void 0:a.thucDons)||{};return c.a.createElement(i.Suspense,{key:null===t||void 0===t?void 0:t.id,fallback:c.a.createElement(y.a,{className:"osac-spin"})},c.a.createElement(R,Object.assign({},e,{userConfig:G,userConfigHandle:N,state:Object(u.a)(Object(u.a)({},w),g),isHideStyle:o,onHideDuTru:ue,nguyenLieusTrongMonAn:Q,shiftDuTruDataCustomers:s,shiftDuTruData:l,thucDonsDatas:d,shiftConfig:t,customerGroup:B,khachHangsArray:H,cauHinhDuTrusArray:S})))}))),c.a.createElement(i.Suspense,{fallback:c.a.createElement(y.a,{className:"osac-spin"})},c.a.createElement(U,{userConfig:G,userConfigHandle:N,onCancel:function(){return t.push("?")},customerGroup:B,customerId:L,nguyenLieusTrongMonAn:Q,duTruWeekData:Z})))}));t.default=x}}]);