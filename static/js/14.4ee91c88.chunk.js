(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[14],{1071:function(e,n,t){"use strict";t.d(n,"a",(function(){return O})),t.d(n,"b",(function(){return j})),t.d(n,"c",(function(){return y}));var a=t(9),o=t(5),i=t(3),c=t(1),u=t(436),r=t.n(u),l=t(470),d=t.n(l),v=t(471),s=t(69),g=t.n(s),f=t(41),b=t(11),h=t(465),m=t(13),O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(n){var t=e.userConfig,u=e.tddtState,r=t.coSoId,l=t.yearId,d=t.weekId,v=t.dayId,s=u.shiftsArray,f=g.a.utils.book_new(),h=null===u||void 0===u?void 0:u.nguyenVatLieuTachsArray,m=s.reduce((function(e,n){var t=(null===u||void 0===u?void 0:u[null===n||void 0===n?void 0:n.id])||[];return t=t.map((function(e){return Object(c.a)(Object(c.a)({},e),{},{shiftName:(null===n||void 0===n?void 0:n.name)||""})})),[].concat(Object(i.a)(e),Object(i.a)(t))}),[]).reduce((function(e,n){var t=n.shiftName,i=(null===n||void 0===n?void 0:n.customers)||{};return Object.entries(i).reduce((function(e,n){var i=Object(o.a)(n,2),u=(i[0],i[1]);return((null===u||void 0===u?void 0:u.ingreRecipe)||[]).reduce((function(e,n){var o=null===n||void 0===n?void 0:n.id,i=(null===e||void 0===e?void 0:e[o])||[],r=null===u||void 0===u?void 0:u.name,l=Object(c.a)(Object(c.a)({},n),{},{custName:r,shiftName:t});return i.push(l),Object(c.a)(Object(c.a)({},e),{},Object(a.a)({},o,i))}),e)}),e)}),{}),O=Object.entries(m).reduce((function(e,n){var t=Object(o.a)(n,2),a=(t[0],t[1].reduce((function(e,n){var t=((null===e||void 0===e?void 0:e.tongDinhLuong)||0)+((null===n||void 0===n?void 0:n.tongDinhLuong)||0),a=((null===e||void 0===e?void 0:e.tongGiaSum)||0)+((null===n||void 0===n?void 0:n.tongGiaSum)||0),o=((null===e||void 0===e?void 0:e.tongPhan)||0)+((null===n||void 0===n?void 0:n.tongPhan)||0);return Object(c.a)(Object(c.a)({},n),{},{tongDinhLuong:t,tongPhan:o,tongGiaSum:a})}),{}));return e.push(a),e}),[]),j=["T\xean NL","T\xean \u0110L","T\u1ed5ng \u0110L","Gi\xe1 NL","Th\xe0nh ti\u1ec1n","NCC"],y=Object(b.groupBy)(O,"nhaCungCapId");Object.entries(y).forEach((function(e){var n=Object(o.a)(e,2),t=n[0],a=n[1].map((function(e){var n=e.tenNguyenLieu,t=void 0===n?"":n,a=e.tongDinhLuong,o=e.tenDonViTinh,i=void 0===o?"":o,c=e.tenNhaCungCap,u=void 0===c?"":c,r=e.giaNguyenLieu,l=void 0===r?0:r;return[t,i,a,l,a*l,u]})),c=g.a.utils.aoa_to_sheet([j].concat(Object(i.a)(a)));g.a.utils.book_append_sheet(f,c,"".concat(t).toUpperCase())}));var p=["tenNguyenLieu","tongDinhLuong"].concat(Object(i.a)(s.map((function(e){return e.name})))),T=["T\xean NL","T\u1ed5ng \u0110L"].concat(Object(i.a)(s.map((function(e){return e.name})))),I=Object.entries(m).filter((function(e){var n=Object(o.a)(e,2),t=(n[0],n[1]);return h.some((function(e){var n;return e===(null===t||void 0===t||null===(n=t[0])||void 0===n?void 0:n.tenNguyenLieu)}))})).map((function(e){var n=Object(o.a)(e,2),t=(n[0],n[1].reduce((function(e,n){var t=n.tenNguyenLieu,o=n.shiftName,i=n.tongDinhLuong,u=((null===e||void 0===e?void 0:e.tongDinhLuong)||0)+i,r=((null===e||void 0===e?void 0:e[o])||0)+i;return Object(c.a)(Object(c.a)({},e),{},Object(a.a)({tenNguyenLieu:t,tongDinhLuong:u},o,r))}),{}));return p.map((function(e){return(null===t||void 0===t?void 0:t[e])||""}))})),x=g.a.utils.aoa_to_sheet([T].concat(Object(i.a)(I)));g.a.utils.book_append_sheet(f,x,"TachTheoCa"),setTimeout((function(){try{g.a.writeFile(f,"order_".concat(v,"_week_").concat(r,"-").concat(d,"-").concat(l,".xlsx"))}catch(e){console.log(e)}}),1e3)}},j=function(e){return function(n){var t=e.tddtState,o=n.duTruState,u=e.userConfig,l=t.khachHangsArray,s=t.khachHangs,g=t.nhomKhachHangs,b=t.cauHinhDuTrus,O=t.shiftsArray,j=(new f.a).getDuTruConfigConstantsArray(),y=O.reduce((function(e,n){var t="".concat(null===n||void 0===n?void 0:n.id),o=(null===e||void 0===e?void 0:e[t])||{},u=j.reduce((function(e,n){var o,u=n.id,r=l.reduce((function(e,n){var a,o,c=n.id,r=null===b||void 0===b||null===(a=b[c])||void 0===a||null===(o=a[t])||void 0===o?void 0:o[u],l=((null===r||void 0===r?void 0:r.values)||[]).reduce((function(n,t){return e.indexOf(t)>-1?n:[].concat(Object(i.a)(n),[t])}),[]);return[].concat(Object(i.a)(e),Object(i.a)(l))}),[]),d=(null===e||void 0===e?void 0:e.soMonManTheoLoaiMon)||{},v=l.reduce((function(e,n){var o,i,r=n.id,l=n.soMonMan,d=null===b||void 0===b||null===(o=b[r])||void 0===o||null===(i=o[t])||void 0===i?void 0:i[u],v=((null===d||void 0===d?void 0:d.values)||[]).reduce((function(e,n){var t=(null===e||void 0===e?void 0:e[r])||{};return Object(c.a)(Object(c.a)({},e),{},Object(a.a)({},r,Object(c.a)(Object(c.a)({},t),{},Object(a.a)({},n,l))))}),e);return Object(c.a)(Object(c.a)({},e),v)}),d);return Object(c.a)(Object(c.a)({},e),{},(o={},Object(a.a)(o,u,r),Object(a.a)(o,"soMonManTheoLoaiMon",v),o))}),o);return Object(c.a)(Object(c.a)({},e),{},Object(a.a)({},t,u))}),{}),p=O.reduce((function(e,n){var o="".concat(n.id),i=((null===t||void 0===t?void 0:t[o])||[]).reduce((function(e,n){var t=Object(c.a)(Object(c.a)({},n),{},{nguyenLieus:(null===n||void 0===n?void 0:n.ingreRecipe)||[]});return Object.assign(e,Object(a.a)({},n.id,t)),e}),{});return Object.assign(e,Object(a.a)({},o,i)),e}),{});!function(e){var n=e.shiftsArray,t=e.loaiMonShiftAccData,a=e.shiftAccData,o=e.customerGroups,c=e.userConfig,u=(e.customers,c.coSoId),l=c.yearId,s=c.weekId,g=c.dayId,f=function(e){var n=e.shift,c="".concat(n.id),u=(null===t||void 0===t?void 0:t[c])||[],r=(null===a||void 0===a?void 0:a[c])||{},l=h.a.getXuatMenuPdfHeaderFields().reduce((function(e,n){var t=n.id,a=n.header||[],o=(u[t]||[]).reduce((function(e,n){var t=null===r||void 0===r?void 0:r[n],a=null===t||void 0===t?void 0:t.recipeId,o=(null===t||void 0===t?void 0:t.tongPhan)||0,c=(null===t||void 0===t?void 0:t.customers)||{},u=(null===t||void 0===t?void 0:t.nguyenLieus)||{},l=Object.keys(c).reduce((function(e,n){var t=null===c||void 0===c?void 0:c[n],a="".concat(t.name||"",": ").concat(t.tongPhan||0);return[].concat(Object(i.a)(e),[a])}),[]),d=Object.keys(c).reduce((function(e,n){var t=null===c||void 0===c?void 0:c[n];if(!t.ghiChu)return e;var a="".concat(t.name||"",": ").concat(t.ghiChu||"");return[].concat(Object(i.a)(e),[a])}),[]),v=Object.keys(u),s=v.length;if(!a)return e;var g=l.join(", ")+"\n"+d.join("\n"),f=[{text:a,style:"nameRecipeTable",alignment:"left",fillColor:"lightcyan"},{text:"".concat(o," ph\u1ea7n"),style:"nameRecipeTable",alignment:"center",fillColor:"lightcyan"},{text:"Gram",style:"textTable9",alignment:"center",fillColor:"lightcyan",align:"center"},{text:"S\u1ed1 l\u01b0\u1ee3ng",style:"textTable9",alignment:"center",fillColor:"lightcyan",align:"center"},{text:"T\u0110L",style:"textTable9",alignment:"center",fillColor:"lightcyan",align:"center"},{text:g,style:"textTable9",alignment:"left",rowSpan:s+1}],b=v.reduce((function(e,n){var t=null===u||void 0===u?void 0:u[n],a=((null===t||void 0===t?void 0:t.dinhLuong)||0)+0,o=(null===t||void 0===t?void 0:t.tongDinhLuong)||0;o=Math.round(10*o)/10;var c=[{text:"",style:"textTable9",alignment:"left"},{text:t.tenNguyenLieu,style:"textTable9",alignment:"left"},{text:a,style:"textTable9",alignment:"center"},{text:o,style:"textTable10Bold",alignment:"center"},{text:t.tenDonViTinh,style:"textTable9",alignment:"center"},{text:"",style:"textTable9",alignment:"right"}];return[].concat(Object(i.a)(e),[c])}),[]);return[].concat(Object(i.a)(e),[f],Object(i.a)(b))}),[]);return 0===o.length?e:[].concat(Object(i.a)(e),[a],Object(i.a)(o))}),[]),d=Object.keys(o),v=(null===o||void 0===o?void 0:o[null===d||void 0===d?void 0:d[0]])||{},s=((null===u||void 0===u?void 0:u.monManConfig)||[]).reduce((function(e,n){var t=((null===r||void 0===r?void 0:r[n])||{}).customers,a=void 0===t?{}:t;return e+Object.values(a).reduce((function(e,n){var t=n.soMonMan;return e+n.tongPhan/t}),0)}),0)+((null===u||void 0===u?void 0:u.vegConfig)||[]).reduce((function(e,n){var t;return e+((null===r||void 0===r||null===(t=r[n])||void 0===t?void 0:t.tongPhan)||0)}),0)/2;s=Math.round(s);var g=(null===v||void 0===v?void 0:v.dinhLuongGao)||0,f=s*g/1e3;f=Math.round(10*f)/10;var b=[{text:"S\u1ed1 ph\u1ea7n c\u01a1m: ".concat(s),style:"textTable9",alignment:"left"},{text:"G\u1ea1o",style:"textTable9",alignment:"left"},{text:g,style:"textTable9",alignment:"center"},{text:f,style:"textTable10Bold",alignment:"center"},{text:"kg",style:"textTable9",alignment:"center"},{text:"",style:"textTable9",alignment:"right"}];return[].concat(Object(i.a)(l),[[{text:"VIII. G\u1ea0O",style:"kindRecipeTable",fillColor:"yellow",alignment:"left",colSpan:5},"","","","",""],b])};try{var b=d.a.pdfMake.vfs;r.a.vfs=b;var O=[120,100,40,50,40,"*"],j={pageSize:"A4",pageOrientation:"portal",pageMargins:[15,15,15,15],content:n.reduce((function(e,t,a){var o,c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{style:"headerStyle",columns:[[{text:"D\u1ef0 TR\xd9: ".concat(e),style:"donDatHangStyle",bold:!0}]]}}(h.a.getTextHeader({canTinId:(null===m.k||void 0===m.k||null===(o=m.k[u])||void 0===o?void 0:o.name)||u,yearId:l,weekId:s,dayId:g,shiftName:t.name})),r={table:{layout:"lightHorizontalLines",headerRows:1,dontBreakRows:!0,widths:O,body:[["T\xean m\xf3n","NL/SPA","\u0110L(gam)","SLTP","T\u0110L","Ghi ch\xfa/ h\u01b0\u1edbng d\u1eabn"].map((function(e){return{text:e,style:"tableHeader",fillColor:"lightblue",alignment:"center"}}))].concat(Object(i.a)(f({shift:t})))}},d=a<n.length-1?{text:"",pageBreak:"before"}:{};return[].concat(Object(i.a)(e),[c,"",r,d])}),[]),styles:v.a,footer:function(e,n){return{columns:[{text:"".concat(e," of ").concat(n),alignment:"right",margin:[0,0,15,10]}]}}},y=window.open("","_blank");r.a.createPdf(j).open({},y)}catch(p){console.log(p)}}({duTruState:o,customers:s,customerGroups:g,shiftsArray:O,loaiMonShiftAccData:y,shiftAccData:p,userConfig:u})}},y=function(){var e,n,t,a,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=i.duTruWeekData,u=i.thucDonDuTruState,r=i.shiftId,l=i.kindId,d=i.dayId,v=(null===u||void 0===u?void 0:u[r])||[],s=v.findIndex((function(e){return"".concat(e.name)==="".concat(l)})),g=s+1,f=null===v||void 0===v?void 0:v[g],b=null===f||void 0===f?void 0:f.name,h=null===c||void 0===c||null===(e=c[r])||void 0===e||null===(n=e.thucDons)||void 0===n||null===(t=n[d])||void 0===t||null===(a=t.kindIds)||void 0===a||null===(o=a[b])||void 0===o?void 0:o.recipeId;return{nextRecipeKindId:b,nextRecipeId:h}}},1135:function(e,n,t){"use strict";t.r(n);var a=t(3),o=t(1),i=t(5),c=(t(258),t(16),t(0)),u=t.n(c),r=t(82),l=t(457),d=t(110),v=t(11),s=t(34),g=t(7),f=t(143),b=t(56),h=t(27),m=t(41),O=t(1064),j=t(13),y=t(458),p=t(1071),T=function(e){var n,t=e.history,r=e.location,T=e.style,I=e.classNames,x=e.customerGroup,D=e.nguyenLieusTrongMonAn,L=e.duTruWeekData,k=e.userConfig,C=Object(y.b)(),S=Object(i.a)(C,1)[0],N=S.cauHinhDuTruByShifts,M=S.nguyenLieus,R=u.a.useMemo((function(){return new f.b}),[]),_=u.a.useMemo((function(){return new h.a}),[]),w=k.coSoId,A=k.yearId,P=k.weekId,E=Object(c.useContext)(b.a),G=E.duTruDispatch,H=Object(c.useContext)(b.b),B=H.recipeState,K=H.duTruSettingState,F=null===K||void 0===K?void 0:K[m.a.collections.recipeKind.datas],Q=R.getQuery(r,s.c.MODAL_ID),V=R.getQuery(r,s.c.SHIFT_ID),W=R.getQuery(r,s.c.KIND_ID),z=R.getQuery(r,s.c.DAY_ID),J=R.getQuery(r,s.c.RECIPE_ID),U=Object(c.useRef)(null),Y=Object(c.useState)([]),X=Object(i.a)(Y,2),q=X[0],Z=X[1],$=Object(c.useState)(!1),ee=Object(i.a)($,2),ne=ee[0],te=ee[1],ae=Object(c.useState)([]),oe=Object(i.a)(ae,2),ie=oe[0],ce=oe[1];Object(c.useEffect)((function(){var e=Q===s.a.selectRecipe.id;te(e)}),[Q]),Object(c.useEffect)((function(){var e,n=(null===B||void 0===B?void 0:B.recipeDatasArray)||[],t=null===F||void 0===F||null===(e=F[W])||void 0===e?void 0:e.recipeKindMap,i=[];if(t){var c=j.p.find((function(e){return e.id===t}))||{};i=(null===c||void 0===c?void 0:c.kinds)||[],ce(i)}var u=Object(v.groupBy)(n,"categoryRecipe"),r=i.reduce((function(e,n){var t=u[n]||[];return t=t.map((function(e){var n=e.id,t=(null===D||void 0===D?void 0:D[n])||[];return Object(o.a)(Object(o.a)({},e),{},{nguyenLieus:t})})),[].concat(Object(a.a)(e),Object(a.a)(t))}),[]);Z(r)}),[B,F,W,D]);var ue=function(){var e=Object(p.c)({thucDonDuTruState:S,duTruWeekData:L,shiftId:V,dayId:z,kindId:W}),n=e.nextRecipeKindId,a=e.nextRecipeId;if(n){var o=[[s.c.MODAL_ID,s.a.selectRecipe.id],[s.c.SHIFT_ID,V],[s.c.KIND_ID,n],[s.c.DAY_ID,z],[s.c.RECIPE_ID,a]];R.pushURL(t,o)}},re=s.a.selectRecipe.getTitle([null===F||void 0===F||null===(n=F[W])||void 0===n?void 0:n.name,Object(g.d)(x.giaPhanAn||0)].join(" - "));return ne?u.a.createElement(l.a,{visible:ne,onCancel:function(){return t.push("?")},footer:null,centered:!0,mask:!1,transitionName:"none",maskTransitionName:"none",className:"selectRecipeModal",style:{}},u.a.createElement("div",{className:"font-weight-bold text-center"},re),u.a.createElement("div",{className:"text-success text-center mb-3"},u.a.createElement("strong",null,ie.join(", "))),u.a.createElement("button",{className:"btn btn-sm btn-success btn-block mb-2",onClick:ue},"Qua m\xf3n ti\u1ebfp theo"),u.a.createElement(d.a,{id:"selectRecipeModalId",ref:U,showSearch:!0,value:J,placeholder:"Ch\u1ecdn m\xf3n \u0103n",onChange:function(e){return function(e){if(e){G("start");var n=V,t="1592732071730"==="".concat(V);t&&(n="1593510547894");var a="1592806823009"==="".concat(V);a&&(n="1593510548787");var o=[w,A,P,"shiftIds",V,"thucDons",z,"kindIds",W],i=[w,A,P,"shiftIds",n,"thucDons",z,"kindIds",W],c={recipeId:e,kindId:W};if(ue(),O.a.updateThucDonDuTru(o,c,(function(){var e=(null===c||void 0===c?void 0:c.recipeId)||"";Object(g.w)("updated ".concat(e," success!"),"bottomRight")}),{})(E),t)O.a.setThucDonDuTru(i,c,v.noop,{})(E);else if(a){var u;(null===N||void 0===N||null===(u=N[n])||void 0===u?void 0:u[W])&&O.a.setThucDonDuTru(i,c,v.noop,{})(E)}}}(e)},optionFilterProp:"children",filterOption:function(e,n){var t=Object(g.y)(n.value),a=Object(g.y)(e);return t.indexOf(a)>=0},className:["selectVendor",I.join(" ")].join(" "),autoFocus:!0,style:T},(q||[]).map((function(e){return u.a.createElement(d.a.Option,{key:e.id,value:e.id},e.name," ",function(e){if(0===((null===e||void 0===e?void 0:e.nguyenLieus)||[]).length)return null;var n=_.getRecipePrice(e,M),t=x.giaPhanAn||0;return u.a.createElement("span",{className:"cost-style"},"(".concat(Object(g.j)(n,t),"%)"))}(e))})))):null};T.defaultProps={userConfig:{},onSelect:v.noop,classNames:[],style:{},nguyenLieusTrongMonAn:{},nguyenLieus:{}},n.default=Object(r.o)(T)}}]);