(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[22],{1058:function(e,t,n){"use strict";n.r(t);var a=n(3),u=n(9),o=n(1),c=n(6),i=n(0),r=n.n(i),l=n(17),s=n(28),d=n(30),b=n(262),g=n(11),f=n(23),m=n(484),O=n(7),j=n(485),h=Object(i.memo)((function(e){var t,n,i=e.state,h=e.actions,v=i.loading,y=i.nhaCungCaps,C=i.nguyenLieuChosArray,L=i.chonNguyenLieuFilters,p=i.nhomNguyenLieuDLCFilter,N=i.selectedNguyenLieu,S=i.nguyenLieuTransfers,T=i.nhomNguyenLieus,D=i.hangTonComs,E=r.a.useState([]),w=Object(c.a)(E,2),k=w[0],R=w[1],B=r.a.useState([]),H=Object(c.a)(B,2),M=H[0],x=H[1],F=r.a.useMemo((function(){if(!C)return{};var e=Object(g.groupBy)(C,"tenNhaCungCap");return{filters:Object.keys(e).map((function(e){return{text:e,value:e}})),onFilter:function(e,t){return(null===t||void 0===t?void 0:t.tenNhaCungCap)===e}}}),[C]),I=function(e){return h.onRemoveItemLuaChonNguyenLieu(e)},K=Object(s.useModal)(),P=r.a.useMemo((function(){var e,t=null===K||void 0===K||null===(e=K.selectedData)||void 0===e?void 0:e.name;return{title:"".concat(t).toUpperCase(),Body:function(e){return r.a.createElement(b.b,Object.assign({},e,{state:i,actions:h,isTaoPhieu:!0}))},footer:!1,maskClosable:!1,width:500}}),[K.selectedData]),V=function(e){K.open()(Object(o.a)(Object(o.a)({},e),{},{typeOfInput:"tongDinhLuong"}))},A=Object(s.useModal)(),J=r.a.useMemo((function(){var e=N||{},t=e.name,n=e.nhaCungCapId,a=e.tongDinhLuong,u=void 0===a?0:a;return{title:"".concat(t," - NCC: ").concat(n," - SL: ").concat(Object(O.f)(u)),Body:function(e){return r.a.createElement(m.b,Object.assign({},e,{state:i,actions:h}))},footer:!1,maskClosable:!0,actions:h,width:800}}),[N,i]),z=Object(d.o)(),U=Object(c.a)(z,3),W=U[0],q=U[1],G=U[2],Q=r.a.useMemo((function(){return(new b.c).getTableColumns({searchText:W,setSearchText:q,searchInput:G,onDeleteItem:I,openEditTongDinhLuong:V,actions:h,nguyenLieuTransfers:S,transferHandle:A}).map((function(e){return"tenNhaCungCap"===e.id?Object(o.a)(Object(o.a)(Object(o.a)({},e),F),{},{filteredValue:(null===L||void 0===L?void 0:L.tenNhaCungCap)||null}):"name"===e.id?Object(o.a)(Object(o.a)({},e),{},{filteredValue:(null===L||void 0===L?void 0:L.name)||null}):"tenNhomNguyenLieu"===e.id?Object(o.a)(Object(o.a)(Object(o.a)({},e),p),{},{filteredValue:(null===L||void 0===L?void 0:L.tenNhomNguyenLieu)||null}):"tongDinhLuong"===e.id?Object(o.a)(Object(o.a)(Object(o.a)({},e),Object(l.f)("tongDinhLuong")),{},{filteredValue:(null===L||void 0===L?void 0:L.tongDinhLuong)||null}):e}))}),[W,G,F,L,S,p]),X=r.a.useState([]),Y=Object(c.a)(X,2),Z=Y[0],$=Y[1];r.a.useEffect((function(){if(!C)return $([]);var e=C.map((function(e){var t=e.id,n=(null===D||void 0===D?void 0:D[t])||0;return Object(o.a)(Object(o.a)({},e),{},{tonKho:n})}));e=(e=Object(g.orderBy)(e,["tenNhaCungCap","tenNguyenLieu"])).map((function(e){return Object.entries(e).reduce((function(e,t){var n=Object(c.a)(t,2),a=n[0],i=n[1];return"children"===a?e:Object(o.a)(Object(o.a)({},e),{},Object(u.a)({},a,i))}),{})})),$(e)}),[C,y,T,D]),r.a.useEffect((function(){var e=Object(f.p)(L,Z||[]);h.setState({filteredChonNguyenLieuArray:e})}),[L,Z]);var _=Object(d.d)(),ee=Object(c.a)(_,2),te=ee[0],ne=ee[1];r.a.useEffect((function(){return h.getHangTonComs(ne),h.setState({selectedTime:te,dayPickerHandle:ne}),function(){}}),[te]),r.a.useEffect((function(){return h.getLuaChonNguyenLieus(),h.getTransferNguyenLieus(),function(){h.setState({nguyenLieuDataSource:[]}),Object(j.t)()}}),[]);var ae=Object(d.b)(),ue=Object(c.a)(ae,1)[0],oe=Object(d.b)(),ce=Object(c.a)(oe,1)[0],ie={breadcrumbs:Object(a.a)((null===e||void 0===e||null===(t=e.breadcrumb)||void 0===t?void 0:t.breadcrumbs)||[]),buttons:Object(a.a)((null===e||void 0===e||null===(n=e.breadcrumb)||void 0===n?void 0:n.buttons)||[])};return r.a.createElement("div",{className:"mb-5"},r.a.createElement(s.Breadcrumb,{breadcrumb:ie}),r.a.createElement(b.e,Object.assign({},e,{selectedTime:te,dayPickerHandle:ne,addButtonNguyenLieuDuTruHandle:ue,addButtonNguyenLieuChungHandle:ce,dataSource:Z,setDataSource:$,setSelectedRowKeys:R,setSelectedRows:x})),r.a.createElement("div",{className:"chonNguyenLieuTable"},r.a.createElement(s.AntTable,{rowKey:"id",size:"small",bordered:!0,dataSource:Z,columns:Q,loading:v,rowSelection:{columnWidth:30,selectedRowKeys:k,onChange:function(e,t){R(e),x(t)},getCheckboxProps:function(e){return{disabled:null===e||void 0===e?void 0:e.isChildren,name:e.name}}},scroll:{x:800,y:500},onChange:function(e,t){h.setState({chonNguyenLieuFilters:t})},onRow:function(e){return{onClick:function(){console.log(e)}}}})),r.a.createElement(b.d,Object.assign({},e,{chonNguyenLieuFilters:L,selectedTime:te,selectedRows:M,columns:Q,onSuccess:function(){R([]),x([])}})),K.getRender(P),A.getRender(J))}));t.default=h}}]);